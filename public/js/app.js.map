{"version":3,"sources":["lodash.min.js","orderTrackedTable.js","jquery.datetimepicker.js","angular.datetime.js","common.js","user.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5nCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"app.js","sourcesContent":["/*!\n Lo-Dash 0.10.0 lodash.com/license\n Underscore.js 1.4.2 underscorejs.org/LICENSE\n*/\n;(function(e,t){function s(e){if(e&&e.__wrapped__)return e;if(!(this instanceof s))return new s(e);this.__wrapped__=e}function o(e,t,n){t||(t=0);var r=e.length,i=r-t>=(n||Z);if(i)for(var s={},n=t-1;++n<r;){var o=e[n]+\"\";(bt.call(s,o)?s[o]:s[o]=[]).push(e[n])}return function(n){if(i){var r=n+\"\";return bt.call(s,r)&&-1<q(s[r],n)}return-1<q(e,n,t)}}function u(e){return e.charCodeAt(0)}function a(e,n){var r=e.b,i=n.b,e=e.a,n=n.a;if(e!==n){if(e>n||e===t)return 1;if(e<n||n===t)return-1}return r<i?-1:1}function f\n(e,t,n){function r(){var u=arguments,a=s?this:t;return i||(e=t[o]),n.length&&(u=u.length?n.concat(St.call(u)):n),this instanceof r?(d.prototype=e.prototype,a=new d,u=e.apply(a,u),T(u)?u:a):e.apply(a,u)}var i=x(e),s=!n,o=t;return s&&(n=t),i||(t=e),r}function l(e,n){return e?\"function\"!=typeof e?function(t){return t[e]}:n!==t?function(t,r,i){return e.call(n,t,r,i)}:e:X}function c(){for(var e={b:\"\",c:\"\",e:qt,f:Qt,g:\"\",h:zt,i:Vt,j:dt,k:\"\",l:n},t,r=0;t=arguments[r];r++)for(var i in t)e[i]=t[i];t=e.a,e\n.d=/^[^,]+/.exec(t)[0],r=\"var i,x,l=\"+e.d+\",t=\"+e.d+\";if(!\"+e.d+\")return t;\"+e.k+\";\",e.b?(r+=\"var m=l.length;i=-1;if(typeof m=='number'){\",e.i&&(r+=\"if(k(l)){l=l.split('')}\"),r+=\"while(++i<m){x=l[i];\"+e.b+\"}}else {\"):e.h&&(r+=\"var m=l.length;i=-1;if(m&&j(l)){while(++i<m){x=l[i+=''];\"+e.g+\"}}else {\"),e.e||(r+=\"var u=typeof l=='function'&&s.call(l,'prototype');\");if(e.f&&e.l)r+=\"var q=-1,r=p[typeof l]?n(l):[],m=r.length;while(++q<m){i=r[q];\",e.e||(r+=\"if(!(u&&i=='prototype')){\"),r+=\"x=l[i];\"+e.g+\"\"\n,e.e||(r+=\"}\");else{r+=\"for(i in l){\";if(!e.e||e.l)r+=\"if(\",e.e||(r+=\"!(u&&i=='prototype')\"),!e.e&&e.l&&(r+=\"&&\"),e.l&&(r+=\"h.call(l,i)\"),r+=\"){\";r+=\"x=l[i];\"+e.g+\";\";if(!e.e||e.l)r+=\"}\"}r+=\"}\";if(e.e){r+=\"var f=l.constructor;\";for(i=0;7>i;i++)r+=\"i='\"+e.j[i]+\"';if(\",\"constructor\"==e.j[i]&&(r+=\"!(f&&f.prototype===l)&&\"),r+=\"h.call(l,i)){x=l[i];\"+e.g+\"}\"}if(e.b||e.h)r+=\"}\";return r+=e.c+\";return t\",Function(\"e,h,j,k,p,n,s\",\"return function(\"+t+\"){\"+r+\"}\")(l,bt,m,N,Yt,Lt,Et)}function h(e){return\"\\\\\"+\nZt[e]}function p(e){return un[e]}function d(){}function v(e){return an[e]}function m(e){return xt.call(e)==_t}function g(e){var t=i;if(!e||\"object\"!=typeof e||m(e))return t;var n=e.constructor;return(!$t||\"function\"==typeof e.toString||\"string\"!=typeof (e+\"\"))&&(!x(n)||n instanceof n)?Rt?(sn(e,function(e,n,r){return t=!bt.call(r,n),i}),t===i):(sn(e,function(e,n){t=n}),t===i||bt.call(e,t)):t}function y(e){var t=[];return on(e,function(e,n){t.push(n)}),t}function b(e,t,n,s,o){if(e==r)return e;n&&(t=\ni);if(n=T(e)){var u=xt.call(e);if(!Gt[u]||Wt&&m(e))return e;var a=u==Dt,n=a||(u==jt?cn(e):n)}if(!n||!t)return n?a?St.call(e):rn({},e):e;n=e.constructor;switch(u){case Pt:case Ht:return new n(+e);case Bt:case It:return new n(e);case Ft:return n(e.source,ot.exec(e))}s||(s=[]),o||(o=[]);for(u=s.length;u--;)if(s[u]==e)return o[u];var f=a?n(e.length):{};return s.push(e),o.push(f),(a?pn:on)(e,function(e,n){f[n]=b(e,t,r,s,o)}),f}function w(e){var t=[];return sn(e,function(e,n){x(e)&&t.push(n)}),t.sort()\n}function E(e){var t={};return on(e,function(e,n){t[e]=n}),t}function S(e,t,s,o){if(e===t)return 0!==e||1/e==1/t;if(e==r||t==r)return e===t;var u=xt.call(e);if(u!=xt.call(t))return i;switch(u){case Pt:case Ht:return+e==+t;case Bt:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case Ft:case It:return e==t+\"\"}var a=u==Dt||u==_t;if(Wt&&!a&&(a=m(e))&&!m(t))return i;if(!a){if(e.__wrapped__||t.__wrapped__)return S(e.__wrapped__||e,t.__wrapped__||t);if(u!=jt||$t&&(\"function\"!=typeof e.toString&&\"string\"==typeof \n(e+\"\")||\"function\"!=typeof t.toString&&\"string\"==typeof (t+\"\")))return i;var u=e.constructor,f=t.constructor;if(u!=f&&(!x(u)||!(u instanceof u&&x(f)&&f instanceof f)))return i}s||(s=[]),o||(o=[]);for(u=s.length;u--;)if(s[u]==e)return o[u]==t;var u=-1,f=n,l=0;s.push(e),o.push(t);if(a){l=e.length;if(f=l==t.length)for(;l--&&(f=S(e[l],t[l],s,o)););return f}for(var c in e)if(bt.call(e,c)&&(l++,!bt.call(t,c)||!S(e[c],t[c],s,o)))return i;for(c in t)if(bt.call(t,c)&&!(l--))return i;if(qt)for(;7>++u;)if(c=\ndt[u],bt.call(e,c)&&(!bt.call(t,c)||!S(e[c],t[c],s,o)))return i;return n}function x(e){return\"function\"==typeof e}function T(e){return e?Yt[typeof e]:i}function N(e){return xt.call(e)==It}function C(e,t,n){var i=arguments,s=0,o=2,u=i[3],a=i[4];n!==Y&&(u=[],a=[],\"number\"!=typeof n&&(o=i.length));for(;++s<o;)on(i[s],function(t,n){var i,s,o;if(t&&((s=ln(t))||cn(t))){for(var f=u.length;f--;)if(i=u[f]==t)break;i?e[n]=a[f]:(u.push(t),a.push(o=(o=e[n],s)?ln(o)?o:[]:cn(o)?o:{}),e[n]=C(o,t,Y,u,a))}else t!=\nr&&(e[n]=t)});return e}function k(e){var t=[];return on(e,function(e){t.push(e)}),t}function L(e,t,n){var r=-1,s=e?e.length:0,o=i,n=(0>n?At(0,s+n):n)||0;return\"number\"==typeof s?o=-1<(N(e)?e.indexOf(t,n):q(e,t,n)):pn(e,function(e){if(++r>=n)return!(o=e===t)}),o}function A(e,t,r){var i=n,t=l(t,r);if(ln(e))for(var r=-1,s=e.length;++r<s&&(i=!!t(e[r],r,e)););else pn(e,function(e,n,r){return i=!!t(e,n,r)});return i}function O(e,t,n){var r=[],t=l(t,n);if(ln(e))for(var n=-1,i=e.length;++n<i;){var s=e[n]\n;t(s,n,e)&&r.push(s)}else pn(e,function(e,n,i){t(e,n,i)&&r.push(e)});return r}function M(e,t,n){var r,t=l(t,n);return pn(e,function(e,n,s){if(t(e,n,s))return r=e,i}),r}function _(e,t,n){var r=-1,i=e?e.length:0,s=Array(\"number\"==typeof i?i:0),t=l(t,n);if(ln(e))for(;++r<i;)s[r]=t(e[r],r,e);else pn(e,function(e,n,i){s[++r]=t(e,n,i)});return s}function D(e,t,n){var r=-Infinity,i=-1,s=e?e.length:0,o=r;if(t||!ln(e))t=!t&&N(e)?u:l(t,n),pn(e,function(e,n,i){n=t(e,n,i),n>r&&(r=n,o=e)});else for(;++i<s;)e[\ni]>o&&(o=e[i]);return o}function P(e,t){var n=[];return pn(e,function(e){n.push(e[t])}),n}function H(e,t,n,r){var s=3>arguments.length,t=l(t,r);return pn(e,function(e,r,o){n=s?(s=i,e):t(n,e,r,o)}),n}function B(e,t,n,r){var s=e,o=e?e.length:0,u=3>arguments.length;if(\"number\"!=typeof o)var a=hn(e),o=a.length;else Vt&&N(e)&&(s=e.split(\"\"));return pn(e,function(e,f,l){f=a?a[--o]:--o,n=u?(u=i,s[f]):t.call(r,n,s[f],f,l)}),n}function j(e,t,n){var r,t=l(t,n);if(ln(e))for(var n=-1,i=e.length;++n<i&&!(r=t(\ne[n],n,e)););else pn(e,function(e,n,i){return!(r=t(e,n,i))});return!!r}function F(e,t,n){if(e)return t==r||n?e[0]:St.call(e,0,t)}function I(e,t){for(var n=-1,r=e?e.length:0,i=[];++n<r;){var s=e[n];ln(s)?wt.apply(i,t?s:I(s)):i.push(s)}return i}function q(e,t,n){var r=-1,i=e?e.length:0;if(\"number\"==typeof n)r=(0>n?At(0,i+n):n||0)-1;else if(n)return r=U(e,t),e[r]===t?r:-1;for(;++r<i;)if(e[r]===t)return r;return-1}function R(e,t,n){return e?St.call(e,t==r||n?1:t):[]}function U(e,t,n,r){for(var i=0,s=\ne?e.length:i,n=n?l(n,r):X,t=n(t);i<s;)r=i+s>>>1,n(e[r])<t?i=r+1:s=r;return i}function z(e,t,n,r){var s=-1,o=e?e.length:0,u=[],a=u;\"function\"==typeof t&&(r=n,n=t,t=i);var f=!t&&74<o;if(f)var c={};n&&(a=[],n=l(n,r));for(;++s<o;){var r=e[s],h=n?n(r,s,e):r;f&&(a=bt.call(c,h+\"\")?c[h]:c[h]=[]);if(t?!s||a[a.length-1]!==h:0>q(a,h))(n||f)&&a.push(h),u.push(r)}return u}function W(e,t){return Kt||Tt&&2<arguments.length?Tt.call.apply(Tt,arguments):f(e,t,St.call(arguments,2))}function X(e){return e}function V\n(e){pn(w(e),function(t){var r=s[t]=e[t];s.prototype[t]=function(){var e=[this.__wrapped__];return wt.apply(e,arguments),e=r.apply(s,e),this.__chain__&&(e=new s(e),e.__chain__=n),e}})}var n=!0,r=null,i=!1,$=\"object\"==typeof exports&&exports,J=\"object\"==typeof global&&global;J.global===J&&(e=J);var K=[],Q=new function(){},G=0,Y=Q,Z=30,et=e._,tt=/[-?+=!~*%&^<>|{(\\/]|\\[\\D|\\b(?:delete|in|instanceof|new|typeof|void)\\b/,nt=/&(?:amp|lt|gt|quot|#x27);/g,rt=/\\b__p\\+='';/g,it=/\\b(__p\\+=)''\\+/g,st=/(__e\\(.*?\\)|\\b__t\\))\\+'';/g\n,ot=/\\w*$/,ut=/(?:__e|__t=)\\(\\s*(?![\\d\\s\"']|this\\.)/g,at=RegExp(\"^\"+(Q.valueOf+\"\").replace(/[.*+?^=!:${}()|[\\]\\/\\\\]/g,\"\\\\$&\").replace(/valueOf|for [^\\]]+/g,\".+?\")+\"$\"),ft=/\\$\\{((?:(?=\\\\?)\\\\?[\\s\\S])*?)}/g,lt=/<%=([\\s\\S]+?)%>/g,ct=/($^)/,ht=/[&<>\"']/g,pt=/['\\n\\r\\t\\u2028\\u2029\\\\]/g,dt=\"constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf\".split(\" \"),vt=Math.ceil,mt=K.concat,gt=Math.floor,yt=at.test(yt=Object.getPrototypeOf)&&yt,bt=Q.hasOwnProperty,wt=K.push,Et=\nQ.propertyIsEnumerable,St=K.slice,xt=Q.toString,Tt=at.test(Tt=St.bind)&&Tt,Nt=at.test(Nt=Array.isArray)&&Nt,Ct=e.isFinite,kt=e.isNaN,Lt=at.test(Lt=Object.keys)&&Lt,At=Math.max,Ot=Math.min,Mt=Math.random,_t=\"[object Arguments]\",Dt=\"[object Array]\",Pt=\"[object Boolean]\",Ht=\"[object Date]\",Bt=\"[object Number]\",jt=\"[object Object]\",Ft=\"[object RegExp]\",It=\"[object String]\",qt,Rt,Ut=(Ut={0:1,length:1},K.splice.call(Ut,0,1),Ut[0]),zt=n;(function(){function e(){this.x=1}var t=[];e.prototype={valueOf:1,y\n:1};for(var n in new e)t.push(n);for(n in arguments)zt=!n;qt=!/valueOf/.test(t),Rt=\"x\"!=t[0]})(1);var Wt=!m(arguments),Xt=\"x\"!=St.call(\"x\")[0],Vt=\"xx\"!=\"x\"[0]+Object(\"x\")[0];try{var $t=(\"[object Object]\",xt.call(e.document||0)==jt)}catch(Jt){}var Kt=Tt&&/\\n|Opera/.test(Tt+xt.call(e.opera)),Qt=Lt&&/^.+$|true/.test(Lt+!!e.attachEvent),Gt={};Gt[_t]=Gt[\"[object Function]\"]=i,Gt[Dt]=Gt[Pt]=Gt[Ht]=Gt[Bt]=Gt[jt]=Gt[Ft]=Gt[It]=n;var Yt={\"boolean\":i,\"function\":n,object:n,number:i,string:i,\"undefined\":i},Zt=\n{\"\\\\\":\"\\\\\",\"'\":\"'\",\"\\n\":\"n\",\"\\r\":\"r\",\"\t\":\"t\",\"\\u2028\":\"u2028\",\"\\u2029\":\"u2029\"};s.templateSettings={escape:/<%-([\\s\\S]+?)%>/g,evaluate:/<%([\\s\\S]+?)%>/g,interpolate:lt,variable:\"\"};var en={a:\"o,v,g\",k:\"for(var a=1,b=typeof g=='number'?2:arguments.length;a<b;a++){if((l=arguments[a])){\",g:\"t[i]=x\",c:\"}}\"},tn={a:\"d,c,w\",k:\"c=e(c,w)\",b:\"if(c(x,i,d)===false)return t\",g:\"if(c(x,i,d)===false)return t\"},nn={b:r},rn=c(en);Wt&&(m=function(e){return e?bt.call(e,\"callee\"):i});var sn=c(tn,nn,{l:i}),on=c(tn,nn\n),un={\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#x27;\"},an=E(un),fn=c(en,{g:\"if(t[i]==null)\"+en.g}),ln=Nt||function(e){return xt.call(e)==Dt};x(/x/)&&(x=function(e){return\"[object Function]\"==xt.call(e)});var cn=yt?function(e){if(!e||\"object\"!=typeof e)return i;var t=e.valueOf,n=\"function\"==typeof t&&(n=yt(t))&&yt(n);return n?e==n||yt(e)==n&&!m(e):g(e)}:g,hn=Lt?function(e){return\"function\"==typeof e&&Et.call(e,\"prototype\")?y(e):T(e)?Lt(e):[]}:y,pn=c(tn);s.VERSION=\"0.10.0\",s.assign=rn,s\n.after=function(e,t){return 1>e?t():function(){if(1>--e)return t.apply(this,arguments)}},s.bind=W,s.bindAll=function(e){for(var t=arguments,n=1<t.length?0:(t=w(e),-1),r=t.length;++n<r;){var i=t[n];e[i]=W(e[i],e)}return e},s.bindKey=function(e,t){return f(e,t,St.call(arguments,2))},s.chain=function(e){return e=new s(e),e.__chain__=n,e},s.clone=b,s.compact=function(e){for(var t=-1,n=e?e.length:0,r=[];++t<n;){var i=e[t];i&&r.push(i)}return r},s.compose=function(){var e=arguments;return function(){for(\nvar t=arguments,n=e.length;n--;)t=[e[n].apply(this,t)];return t[0]}},s.contains=L,s.countBy=function(e,t,n){var r={},t=l(t,n);return pn(e,function(e,n,i){n=t(e,n,i),bt.call(r,n)?r[n]++:r[n]=1}),r},s.debounce=function(e,t,n){function i(){a=r,n||(o=e.apply(u,s))}var s,o,u,a;return function(){var r=n&&!a;return s=arguments,u=this,clearTimeout(a),a=setTimeout(i,t),r&&(o=e.apply(u,s)),o}},s.defaults=fn,s.defer=function(e){var n=St.call(arguments,1);return setTimeout(function(){e.apply(t,n)},1)},s.delay=\nfunction(e,n){var r=St.call(arguments,2);return setTimeout(function(){e.apply(t,r)},n)},s.difference=function(e){for(var t=-1,n=e?e.length:0,r=mt.apply(K,arguments),r=o(r,n),i=[];++t<n;){var s=e[t];r(s)||i.push(s)}return i},s.escape=function(e){return e==r?\"\":(e+\"\").replace(ht,p)},s.every=A,s.filter=O,s.find=M,s.first=F,s.flatten=I,s.forEach=pn,s.forIn=sn,s.forOwn=on,s.functions=w,s.groupBy=function(e,t,n){var r={},t=l(t,n);return pn(e,function(e,n,i){n=t(e,n,i),(bt.call(r,n)?r[n]:r[n]=[]).push(e\n)}),r},s.has=function(e,t){return e?bt.call(e,t):i},s.identity=X,s.indexOf=q,s.initial=function(e,t,n){return e?St.call(e,0,-(t==r||n?1:t)):[]},s.intersection=function(e){var t=arguments,n=t.length,r={},i=[];return pn(e,function(e){if(0>q(i,e)){for(var s=n;--s;)if(!(r[s]||(r[s]=o(t[s])))(e))return;i.push(e)}}),i},s.invert=E,s.invoke=function(e,t){var n=St.call(arguments,2),r=\"function\"==typeof t,i=[];return pn(e,function(e){i.push((r?t:e[t]).apply(e,n))}),i},s.isArguments=m,s.isArray=ln,s.isBoolean=\nfunction(e){return e===n||e===i||xt.call(e)==Pt},s.isDate=function(e){return xt.call(e)==Ht},s.isElement=function(e){return e?1===e.nodeType:i},s.isEmpty=function(e){var t=n;if(!e)return t;var r=xt.call(e),s=e.length;return r==Dt||r==It||r==_t||Wt&&m(e)||r==jt&&\"number\"==typeof s&&x(e.splice)?!s:(on(e,function(){return t=i}),t)},s.isEqual=S,s.isFinite=function(e){return Ct(e)&&!kt(parseFloat(e))},s.isFunction=x,s.isNaN=function(e){return xt.call(e)==Bt&&e!=+e},s.isNull=function(e){return e===r},s\n.isNumber=function(e){return xt.call(e)==Bt},s.isObject=T,s.isPlainObject=cn,s.isRegExp=function(e){return xt.call(e)==Ft},s.isString=N,s.isUndefined=function(e){return e===t},s.keys=hn,s.last=function(e,t,n){if(e){var i=e.length;return t==r||n?e[i-1]:St.call(e,-t||i)}},s.lastIndexOf=function(e,t,n){var r=e?e.length:0;for(\"number\"==typeof n&&(r=(0>n?At(0,r+n):Ot(n,r-1))+1);r--;)if(e[r]===t)return r;return-1},s.map=_,s.max=D,s.memoize=function(e,t){var n={};return function(){var r=t?t.apply(this,arguments\n):arguments[0];return bt.call(n,r)?n[r]:n[r]=e.apply(this,arguments)}},s.merge=C,s.min=function(e,t,n){var r=Infinity,i=-1,s=e?e.length:0,o=r;if(t||!ln(e))t=!t&&N(e)?u:l(t,n),pn(e,function(e,n,i){n=t(e,n,i),n<r&&(r=n,o=e)});else for(;++i<s;)e[i]<o&&(o=e[i]);return o},s.mixin=V,s.noConflict=function(){return e._=et,this},s.object=function(e,t){for(var n=-1,r=e?e.length:0,i={};++n<r;){var s=e[n];t?i[s]=t[n]:i[s[0]]=s[1]}return i},s.omit=function(e,t,n){var r=\"function\"==typeof t,i={};if(r)t=l(t,n);\nelse var s=mt.apply(K,arguments);return sn(e,function(e,n,o){if(r?!t(e,n,o):0>q(s,n,1))i[n]=e}),i},s.once=function(e){var t,s=i;return function(){return s?t:(s=n,t=e.apply(this,arguments),e=r,t)}},s.pairs=function(e){var t=[];return on(e,function(e,n){t.push([n,e])}),t},s.partial=function(e){return f(e,St.call(arguments,1))},s.pick=function(e,t,n){var r={};if(\"function\"!=typeof t)for(var i=0,s=mt.apply(K,arguments),o=s.length;++i<o;){var u=s[i];u in e&&(r[u]=e[u])}else t=l(t,n),sn(e,function(e,n,\ni){t(e,n,i)&&(r[n]=e)});return r},s.pluck=P,s.random=function(e,t){return e==r&&t==r&&(t=1),e=+e||0,t==r&&(t=e,e=0),e+gt(Mt()*((+t||0)-e+1))},s.range=function(e,t,n){e=+e||0,n=+n||1,t==r&&(t=e,e=0);for(var i=-1,t=At(0,vt((t-e)/n)),s=Array(t);++i<t;)s[i]=e,e+=n;return s},s.reduce=H,s.reduceRight=B,s.reject=function(e,t,n){return t=l(t,n),O(e,function(e,n,r){return!t(e,n,r)})},s.rest=R,s.result=function(e,t){var n=e?e[t]:r;return x(n)?e[t]():n},s.shuffle=function(e){var t=-1,n=Array(e?e.length:0);return pn\n(e,function(e){var r=gt(Mt()*(++t+1));n[t]=n[r],n[r]=e}),n},s.size=function(e){var t=e?e.length:0;return\"number\"==typeof t?t:hn(e).length},s.some=j,s.sortBy=function(e,t,n){var r=[],t=l(t,n);pn(e,function(e,n,i){r.push({a:t(e,n,i),b:n,c:e})}),e=r.length;for(r.sort(a);e--;)r[e]=r[e].c;return r},s.sortedIndex=U,s.tap=function(e,t){return t(e),e},s.template=function(e,t,n){e||(e=\"\"),n||(n={});var r,i,o=s.templateSettings,u=0,a=n.interpolate||o.interpolate||ct,f=\"__p += '\",l=n.variable||o.variable,c=\nl;e.replace(RegExp((n.escape||o.escape||ct).source+\"|\"+a.source+\"|\"+(a===lt?ft:ct).source+\"|\"+(n.evaluate||o.evaluate||ct).source+\"|$\",\"g\"),function(t,n,i,s,o,a){i||(i=s),f+=e.slice(u,a).replace(pt,h),f+=n?\"'+__e(\"+n+\")+'\":o?\"';\"+o+\";__p+='\":i?\"'+((__t=(\"+i+\"))==null?'':__t)+'\":\"\",r||(r=o||tt.test(n||i)),u=a+t.length}),f+=\"';\",c||(l=\"obj\",r?f=\"with(\"+l+\"){\"+f+\"}\":(n=RegExp(\"(\\\\(\\\\s*)\"+l+\"\\\\.\"+l+\"\\\\b\",\"g\"),f=f.replace(ut,\"$&\"+l+\".\").replace(n,\"$1__d\"))),f=(r?f.replace(rt,\"\"):f).replace(it,\"$1\").replace\n(st,\"$1;\"),f=\"function(\"+l+\"){\"+(c?\"\":l+\"||(\"+l+\"={});\")+\"var __t,__p='',__e=_.escape\"+(r?\",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}\":(c?\"\":\",__d=\"+l+\".\"+l+\"||\"+l)+\";\")+f+\"return __p}\";try{i=Function(\"_\",\"return \"+f)(s)}catch(p){throw p.source=f,p}return t?i(t):(i.source=f,i)},s.throttle=function(e,t){function n(){a=new Date,u=r,s=e.apply(o,i)}var i,s,o,u,a=0;return function(){var r=new Date,f=t-(r-a);return i=arguments,o=this,0>=f?(clearTimeout(u),a=r,s=e.apply(o,i)\n):u||(u=setTimeout(n,f)),s}},s.times=function(e,t,n){for(var e=+e||0,r=-1,i=Array(e);++r<e;)i[r]=t.call(n,r);return i},s.toArray=function(e){return e&&\"number\"==typeof e.length?(Xt?N(e):\"string\"==typeof e)?e.split(\"\"):St.call(e):k(e)},s.unescape=function(e){return e==r?\"\":(e+\"\").replace(nt,v)},s.union=function(){return z(mt.apply(K,arguments))},s.uniq=z,s.uniqueId=function(e){var t=G++;return e?e+t:t},s.values=k,s.where=function(e,t){var n=hn(t);return O(e,function(e){for(var r=n.length;r--;){var i=\ne[n[r]]===t[n[r]];if(!i)break}return!!i})},s.without=function(e){for(var t=-1,n=e?e.length:0,r=o(arguments,1,20),i=[];++t<n;){var s=e[t];r(s)||i.push(s)}return i},s.wrap=function(e,t){return function(){var n=[e];return wt.apply(n,arguments),t.apply(this,n)}},s.zip=function(e){for(var t=-1,n=e?D(P(arguments,\"length\")):0,r=Array(n);++t<n;)r[t]=P(arguments,t);return r},s.all=A,s.any=j,s.collect=_,s.detect=M,s.drop=R,s.each=pn,s.extend=rn,s.foldl=H,s.foldr=B,s.head=F,s.include=L,s.inject=H,s.methods=\nw,s.select=O,s.tail=R,s.take=F,s.unique=z,V(s),s.prototype.chain=function(){return this.__chain__=n,this},s.prototype.value=function(){return this.__wrapped__},pn(\"pop push reverse shift sort splice unshift\".split(\" \"),function(e){var t=K[e];s.prototype[e]=function(){var e=this.__wrapped__;return t.apply(e,arguments),Ut&&e.length===0&&delete e[0],this.__chain__&&(e=new s(e),e.__chain__=n),e}}),pn([\"concat\",\"join\",\"slice\"],function(e){var t=K[e];s.prototype[e]=function(){var e=t.apply(this.__wrapped__\n,arguments);return this.__chain__&&(e=new s(e),e.__chain__=n),e}}),typeof define==\"function\"&&typeof define.amd==\"object\"&&define.amd?(e._=s,define(function(){return s})):$?\"object\"==typeof module&&module&&module.exports==$?(module.exports=s)._=s:$._=s:e._=s})(this);","/**\r\n * Created by geekzwb on 2017/1/18.\r\n */\r\n/**********\r\n The following directives are necessary in order to track dirty state and validity of the rows\r\n in the table as the user pages within the grid\r\n ------------------------\r\n */\r\n\r\n(function() {\r\n    angular.module(\"zwb\").directive(\"nbgTrackedTable\", nbgTrackedTable);\r\n\r\n    nbgTrackedTable.$inject = [];\r\n\r\n    function nbgTrackedTable() {\r\n        return {\r\n            restrict: \"A\",\r\n            priority: -1,\r\n            require: \"ngForm\",\r\n            controller: nbgTrackedTableController\r\n        };\r\n    }\r\n\r\n    nbgTrackedTableController.$inject = [\"$scope\", \"$parse\", \"$attrs\", \"$element\"];\r\n\r\n    function nbgTrackedTableController($scope, $parse, $attrs, $element) {\r\n        var self = this;\r\n        var tableForm = $element.controller(\"form\");\r\n        var dirtyCellsByRow = [];\r\n        var invalidCellsByRow = [];\r\n\r\n        init();\r\n\r\n        ////////\r\n\r\n        function init() {\r\n            var setter = $parse($attrs.nbgTrackedTable).assign;\r\n            setter($scope, self);\r\n            $scope.$on(\"$destroy\", function() {\r\n                setter(null);\r\n            });\r\n\r\n            self.reset = reset;\r\n            self.isCellDirty = isCellDirty;\r\n            self.setCellDirty = setCellDirty;\r\n            self.setCellInvalid = setCellInvalid;\r\n            self.untrack = untrack;\r\n        }\r\n\r\n        function getCellsForRow(row, cellsByRow) {\r\n            return _.find(cellsByRow, function(entry) {\r\n            //return self.find(cellsByRow, function(entry) {\r\n                return entry.row === row;\r\n            })\r\n        }\r\n\r\n        function isCellDirty(row, cell) {\r\n            var rowCells = getCellsForRow(row, dirtyCellsByRow);\r\n            return rowCells && rowCells.cells.indexOf(cell) !== -1;\r\n        }\r\n\r\n        function reset() {\r\n            dirtyCellsByRow = [];\r\n            invalidCellsByRow = [];\r\n            setInvalid(false);\r\n        }\r\n\r\n        function setCellDirty(row, cell, isDirty) {\r\n            setCellStatus(row, cell, isDirty, dirtyCellsByRow);\r\n        }\r\n\r\n        function setCellInvalid(row, cell, isInvalid) {\r\n            setCellStatus(row, cell, isInvalid, invalidCellsByRow);\r\n            setInvalid(invalidCellsByRow.length > 0);\r\n        }\r\n\r\n        function setCellStatus(row, cell, value, cellsByRow) {\r\n            var rowCells = getCellsForRow(row, cellsByRow);\r\n            if (!rowCells && !value) {\r\n                return;\r\n            }\r\n\r\n            if (value) {\r\n                if (!rowCells) {\r\n                    rowCells = {\r\n                        row: row,\r\n                        cells: []\r\n                    };\r\n                    cellsByRow.push(rowCells);\r\n                }\r\n                if (rowCells.cells.indexOf(cell) === -1) {\r\n                    rowCells.cells.push(cell);\r\n                }\r\n            } else {\r\n                _.remove(rowCells.cells, function(item) {\r\n                    return cell === item;\r\n                });\r\n                if (rowCells.cells.length === 0) {\r\n                    _.remove(cellsByRow, function(item) {\r\n                        return rowCells === item;\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\r\n        function setInvalid(isInvalid) {\r\n            self.$invalid = isInvalid;\r\n            self.$valid = !isInvalid;\r\n        }\r\n\r\n        function untrack(row) {\r\n            _.remove(invalidCellsByRow, function(item) {\r\n                return item.row === row;\r\n            });\r\n            _.remove(dirtyCellsByRow, function(item) {\r\n                return item.row === row;\r\n            });\r\n            setInvalid(invalidCellsByRow.length > 0);\r\n        }\r\n    }\r\n})();\r\n\r\n(function() {\r\n    angular.module(\"zwb\").directive(\"nbgTrackedTableRow\", nbgTrackedTableRow);\r\n\r\n    nbgTrackedTableRow.$inject = [];\r\n\r\n    function nbgTrackedTableRow() {\r\n        return {\r\n            restrict: \"A\",\r\n            priority: -1,\r\n            require: [\"^nbgTrackedTable\", \"ngForm\"],\r\n            controller: nbgTrackedTableRowController\r\n        };\r\n    }\r\n\r\n    nbgTrackedTableRowController.$inject = [\"$attrs\", \"$element\", \"$parse\", \"$scope\"];\r\n\r\n    function nbgTrackedTableRowController($attrs, $element, $parse, $scope) {\r\n        var self = this;\r\n        var row = $parse($attrs.nbgTrackedTableRow)($scope);\r\n        var rowFormCtrl = $element.controller(\"form\");\r\n        var trackedTableCtrl = $element.controller(\"nbgTrackedTable\");\r\n\r\n        self.isCellDirty = isCellDirty;\r\n        self.setCellDirty = setCellDirty;\r\n        self.setCellInvalid = setCellInvalid;\r\n\r\n        function isCellDirty(cell) {\r\n            return trackedTableCtrl.isCellDirty(row, cell);\r\n        }\r\n\r\n        function setCellDirty(cell, isDirty) {\r\n            trackedTableCtrl.setCellDirty(row, cell, isDirty)\r\n        }\r\n\r\n        function setCellInvalid(cell, isInvalid) {\r\n            trackedTableCtrl.setCellInvalid(row, cell, isInvalid)\r\n        }\r\n    }\r\n})();\r\n\r\n(function() {\r\n    angular.module(\"zwb\").directive(\"nbgTrackedTableCell\", nbgTrackedTableCell);\r\n\r\n    nbgTrackedTableCell.$inject = [];\r\n\r\n    function nbgTrackedTableCell() {\r\n        return {\r\n            restrict: \"A\",\r\n            priority: -1,\r\n            scope: true,\r\n            require: [\"^nbgTrackedTableRow\", \"ngForm\"],\r\n            controller: nbgTrackedTableCellController\r\n        };\r\n    }\r\n\r\n    nbgTrackedTableCellController.$inject = [\"$attrs\", \"$element\", \"$scope\"];\r\n\r\n    function nbgTrackedTableCellController($attrs, $element, $scope) {\r\n        var self = this;\r\n        var cellFormCtrl = $element.controller(\"form\");\r\n        var cellName = cellFormCtrl.$name;\r\n        var trackedTableRowCtrl = $element.controller(\"nbgTrackedTableRow\");\r\n\r\n        if (trackedTableRowCtrl.isCellDirty(cellName)) {\r\n            cellFormCtrl.$setDirty();\r\n        } else {\r\n            cellFormCtrl.$setPristine();\r\n        }\r\n        // note: we don't have to force setting validaty as angular will run validations\r\n        // when we page back to a row that contains invalid data\r\n\r\n        $scope.$watch(function() {\r\n            return cellFormCtrl.$dirty;\r\n        }, function(newValue, oldValue) {\r\n            if (newValue === oldValue) return;\r\n\r\n            trackedTableRowCtrl.setCellDirty(cellName, newValue);\r\n        });\r\n\r\n        $scope.$watch(function() {\r\n            return cellFormCtrl.$invalid;\r\n        }, function(newValue, oldValue) {\r\n            if (newValue === oldValue) return;\r\n\r\n            trackedTableRowCtrl.setCellInvalid(cellName, newValue);\r\n        });\r\n    }\r\n})();","/**\r\n * @preserve jQuery DateTimePicker plugin v2.1.9\r\n * @homepage http://xdsoft.net/jqplugins/datetimepicker/\r\n * (c) 2014, Chupurnov Valeriy.\r\n */\r\n(function( $ ) {\r\n\tvar target = null;\r\n\t'use strict'\r\n\tvar default_options  = {\r\n\t\ti18n:{\r\n\t\t\tru:{ // Russian\r\n\t\t\t\tmonths:[\r\n\t\t\t\t\t'Январь','Февраль','Март','Апрель','Май','Июнь','Июль','Август','Сентябрь','Октябрь','Ноябрь','Декабрь'\r\n\t\t\t\t],\r\n\t\t\t\tdayOfWeek:[\r\n\t\t\t\t\t\"Вск\", \"Пн\", \"Вт\", \"Ср\", \"Чт\", \"Пт\", \"Сб\"\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\ten:{ // English\r\n\t\t\t\tmonths: [\r\n\t\t\t\t\t\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\r\n\t\t\t\t],\r\n\t\t\t\tdayOfWeek: [\r\n\t\t\t\t\t\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\tde:{ // German\r\n\t\t\t\tmonths:[\r\n\t\t\t\t\t'Januar','Februar','März','April','Mai','Juni','Juli','August','September','Oktober','November','Dezember'\r\n\t\t\t\t],\r\n\t\t\t\tdayOfWeek:[\r\n\t\t\t\t\t\"So\", \"Mo\", \"Di\", \"Mi\", \"Do\", \"Fr\", \"Sa\"\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\tnl:{ // Dutch\r\n\t\t\t\tmonths:[\r\n\t\t\t\t\t\"januari\", \"februari\", \"maart\", \"april\", \"mei\", \"juni\", \"juli\", \"augustus\", \"september\", \"oktober\", \"november\", \"december\"\r\n\t\t\t\t],\r\n\t\t\t\tdayOfWeek:[\r\n\t\t\t\t\t\"zo\", \"ma\", \"di\", \"wo\", \"do\", \"vr\", \"za\"\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\ttr:{ // Turkish\r\n\t\t\t\tmonths:[\r\n\t\t\t\t\t\"Ocak\", \"Şubat\", \"Mart\", \"Nisan\", \"Mayıs\", \"Haziran\", \"Temmuz\", \"Ağustos\", \"Eylül\", \"Ekim\", \"Kasım\", \"Aralık\"\r\n\t\t\t\t],\r\n\t\t\t\tdayOfWeek:[\r\n\t\t\t\t\t\"Paz\", \"Pts\", \"Sal\", \"Çar\", \"Per\", \"Cum\", \"Cts\"\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\tfr:{ //French\r\n\t\t\t\tmonths:[\r\n\t\t\t    \"Janvier\", \"Février\", \"Mars\", \"Avril\", \"Mai\", \"Juin\", \"Juillet\", \"Août\", \"Septembre\", \"Octobre\", \"Novembre\", \"Décembre\"\r\n\t\t\t\t],\r\n\t\t\t\tdayOfWeek:[\r\n\t\t\t\t\t\"Dim\", \"Lun\", \"Mar\", \"Mer\", \"Jeu\", \"Ven\", \"Sam\"\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\tes:{ // Spanish\r\n\t\t\t\tmonths: [\r\n\t\t\t\t\t\"Enero\", \"Febrero\", \"Marzo\", \"Abril\", \"Mayo\", \"Junio\", \"Julio\", \"Agosto\", \"Septiembre\", \"Octubre\", \"Noviembre\", \"Diciembre\"\r\n\t\t\t\t],\r\n\t\t\t\tdayOfWeek: [\r\n\t\t\t\t\t\"Dom\", \"Lun\", \"Mar\", \"Mié\", \"Jue\", \"Vie\", \"Sáb\"\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\tth:{ // Thai\r\n\t\t\t\tmonths:[\r\n\t\t\t\t\t'มกราคม','กุมภาพันธ์','มีนาคม','เมษายน','พฤษภาคม','มิถุนายน','กรกฎาคม','สิงหาคม','กันยายน','ตุลาคม','พฤศจิกายน','ธันวาคม'\r\n\t\t\t\t],\r\n\t\t\t\tdayOfWeek:[\r\n\t\t\t\t\t'อา.','จ.','อ.','พ.','พฤ.','ศ.','ส.'\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\tpl:{ // Polish\r\n\t\t\t\tmonths: [\r\n\t\t\t\t\t\"styczeń\", \"luty\", \"marzec\", \"kwiecień\", \"maj\", \"czerwiec\", \"lipiec\", \"sierpień\", \"wrzesień\", \"październik\", \"listopad\", \"grudzień\"\r\n\t\t\t\t],\r\n\t\t\t\tdayOfWeek: [\r\n\t\t\t\t\t\"nd\", \"pn\", \"wt\", \"śr\", \"cz\", \"pt\", \"sb\"\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\tpt:{ // Portuguese\r\n\t\t\t\tmonths: [\r\n\t\t\t\t\t\"Janeiro\", \"Fevereiro\", \"Março\", \"Abril\", \"Maio\", \"Junho\", \"Julho\", \"Agosto\", \"Setembro\", \"Outubro\", \"Novembro\", \"Dezembro\"\r\n\t\t\t\t],\r\n\t\t\t\tdayOfWeek: [\r\n\t\t\t\t\t\"Dom\", \"Seg\", \"Ter\", \"Qua\", \"Qui\", \"Sex\", \"Sab\"\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\tch:{ // Simplified Chinese\r\n\t\t\t\tmonths: [\r\n\t\t\t\t\t\"一月\",\"二月\",\"三月\",\"四月\",\"五月\",\"六月\",\"七月\",\"八月\",\"九月\",\"十月\",\"十一月\",\"十二月\"\r\n\t\t\t\t],\r\n\t\t\t\tdayOfWeek: [\r\n\t\t\t\t\t\"日\", \"一\",\"二\",\"三\",\"四\",\"五\",\"六\"\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\tse:{ // Swedish\r\n\t\t\t\tmonths: [\r\n\t\t\t\t\t\"Januari\", \"Februari\", \"Mars\", \"April\", \"Maj\", \"Juni\", \"Juli\", \"Augusti\", \"September\",\"Oktober\", \"November\", \"December\"\r\n\t\t\t\t],\r\n\t\t\t\tdayOfWeek: [\r\n\t\t\t\t\t\"Sön\", \"Mån\", \"Tis\", \"Ons\", \"Tor\", \"Fre\", \"Lör\"\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\tkr:{ // Korean\r\n\t\t\t\tmonths: [\r\n                    \"1월\", \"2월\", \"3월\", \"4월\", \"5월\", \"6월\", \"7월\", \"8월\", \"9월\", \"10월\", \"11월\", \"12월\"\r\n\t\t\t\t],\r\n\t\t\t\tdayOfWeek: [\r\n                    \"일\", \"월\", \"화\", \"수\", \"목\", \"금\", \"토\"\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\tit:{ // Italian\r\n\t\t\t\tmonths: [\r\n\t\t\t\t\t\"Gennaio\", \"Febbraio\", \"Marzo\", \"Aprile\", \"Maggio\", \"Giugno\", \"Luglio\", \"Agosto\", \"Settembre\", \"Ottobre\", \"Novembre\", \"Dicembre\"\r\n\t\t\t\t],\r\n\t\t\t\tdayOfWeek: [\r\n\t\t\t\t\t\"Dom\", \"Lun\", \"Mar\", \"Mer\", \"Gio\", \"Ven\", \"Sab\"\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t},\r\n\t\tvalue:'',\r\n\t\tlang:'en',\r\n\t\tformat:'Y/m/d H:i',\r\n\t\tformatTime:'H:i',\r\n\t\tformatDate:'Y/m/d',\r\n\t\tstep:60,\r\n\t\tcloseOnDateSelect:0,\r\n\t\tcloseOnWithoutClick:true,\r\n\t\ttimepicker:true,\r\n\t\tdatepicker:true,\r\n\t\tminDate:false,\r\n\t\tmaxDate:false,\r\n\t\tminTime:false,\r\n\t\tmaxTime:false,\r\n\t\tallowTimes:[],\r\n\t\topened:false,\r\n\t\tinline:false,\r\n\t\tonSelectDate:function() {},\r\n\t\tonSelectTime:function() {},\r\n\t\tonChangeMonth:function() {},\r\n\t\tonChangeDateTime:function() {},\r\n\t\tonShow:function() {},\r\n\t\tonClose:function() {},\r\n\t\tonGenerate:function() {},\r\n\t\twithoutCopyright:true,\r\n\t\tinverseButton:false,\r\n\t\thours12:false,\r\n\t\tnext:\t'xdsoft_next',\r\n\t\tprev : 'xdsoft_prev',\r\n\t\tdayOfWeekStart:0,\r\n\t\ttimeHeightInTimePicker:25,\r\n\t\ttimepickerScrollbar:true,\r\n\t\ttodayButton:true, // 2.1.0\r\n\t\tdefaultSelect:true, // 2.1.0\r\n\t\tscrollMonth:true,\r\n\t\tscrollTime:true,\r\n\t\tscrollInput:true,\r\n\t\tmask:false,\r\n\t\tvalidateOnBlur:true,\r\n\t\tallowBlank:false,\r\n\t\tyearStart:1950,\r\n\t\tyearEnd:2050,\r\n\t\tstyle:'',\r\n\t\tid:'',\r\n\t\troundTime:'round', // ceil, floor\r\n\t\tclassName:'',\r\n\t\tweekends\t: \t[],\r\n\t\tyearOffset:0\r\n\t};\r\n\t// fix for ie8\r\n\tif ( !Array.prototype.indexOf ) {\r\n\t\tArray.prototype.indexOf = function(obj, start) {\r\n\t\t\t for (var i = (start || 0), j = this.length; i < j; i++) {\r\n\t\t\t\t if (this[i] === obj) { return i; }\r\n\t\t\t }\r\n\t\t\t return -1;\r\n\t\t}\r\n\t};\r\n\t$.fn.xdsoftScroller = function( _percent ) {\r\n\t\treturn this.each(function() {\r\n\t\t\tvar timeboxparent = $(this);\r\n\t\t\tif( !$(this).hasClass('xdsoft_scroller_box') ) {\r\n\t\t\t\tvar pointerEventToXY = function( e ) {\r\n\t\t\t\t\t\tvar out = {x:0, y:0};\r\n\t\t\t\t\t\tif( e.type == 'touchstart' || e.type == 'touchmove' || e.type == 'touchend' || e.type == 'touchcancel' ) {\r\n\t\t\t\t\t\t\tvar touch = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0];\r\n\t\t\t\t\t\t\tout.x = touch.pageX;\r\n\t\t\t\t\t\t\tout.y = touch.pageY;\r\n\t\t\t\t\t\t}else if (e.type == 'mousedown' || e.type == 'mouseup' || e.type == 'mousemove' || e.type == 'mouseover'|| e.type=='mouseout' || e.type=='mouseenter' || e.type=='mouseleave') {\r\n\t\t\t\t\t\t\tout.x = e.pageX;\r\n\t\t\t\t\t\t\tout.y = e.pageY;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn out;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmove = 0,\r\n\t\t\t\t\ttimebox = timeboxparent.children().eq(0),\r\n\t\t\t\t\tparentHeight = timeboxparent[0].clientHeight,\r\n\t\t\t\t\theight = timebox[0].offsetHeight,\r\n\t\t\t\t\tscrollbar = $('<div class=\"xdsoft_scrollbar\"></div>'),\r\n\t\t\t\t\tscroller = $('<div class=\"xdsoft_scroller\"></div>'),\r\n\t\t\t\t\tmaximumOffset = 100,\r\n\t\t\t\t\tstart = false;\r\n\r\n\t\t\t\tscrollbar.append(scroller);\r\n\r\n\t\t\t\ttimeboxparent.addClass('xdsoft_scroller_box').append(scrollbar);\r\n\t\t\t\tscroller.on('mousedown.xdsoft_scroller',function ( event ) {\r\n\t\t\t\t\tif( !parentHeight )\r\n\t\t\t\t\t\ttimeboxparent.trigger('resize_scroll.xdsoft_scroller',[_percent]);\r\n\t\t\t\t\tvar pageY = event.pageY,\r\n\t\t\t\t\t\ttop = parseInt(scroller.css('margin-top')),\r\n\t\t\t\t\t\th1 = scrollbar[0].offsetHeight;\r\n\t\t\t\t\t$(document.body).addClass('xdsoft_noselect');\r\n\t\t\t\t\t$([document.body,window]).on('mouseup.xdsoft_scroller',function arguments_callee() {\r\n\t\t\t\t\t\t$([document.body,window]).off('mouseup.xdsoft_scroller',arguments_callee)\r\n\t\t\t\t\t\t\t.off('mousemove.xdsoft_scroller',move)\r\n\t\t\t\t\t\t\t.removeClass('xdsoft_noselect');\r\n\t\t\t\t\t});\r\n\t\t\t\t\t$(document.body).on('mousemove.xdsoft_scroller',move = function(event) {\r\n\t\t\t\t\t\tvar offset = event.pageY-pageY+top;\r\n\t\t\t\t\t\tif( offset<0 )\r\n\t\t\t\t\t\t\toffset = 0;\r\n\t\t\t\t\t\tif( offset+scroller[0].offsetHeight>h1 )\r\n\t\t\t\t\t\t\toffset = h1-scroller[0].offsetHeight;\r\n\t\t\t\t\t\ttimeboxparent.trigger('scroll_element.xdsoft_scroller',[maximumOffset?offset/maximumOffset:0]);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\r\n\t\t\t\ttimeboxparent\r\n\t\t\t\t\t.on('scroll_element.xdsoft_scroller',function( event,percent ) {\r\n\t\t\t\t\t\tif( !parentHeight )\r\n\t\t\t\t\t\t\ttimeboxparent.trigger('resize_scroll.xdsoft_scroller',[percent,true]);\r\n\t\t\t\t\t\tpercent = percent>1?1:(percent<0||isNaN(percent))?0:percent;\r\n\t\t\t\t\t\tscroller.css('margin-top',maximumOffset*percent);\r\n\t\t\t\t\t\ttimebox.css('marginTop',-parseInt((height-parentHeight)*percent))\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.on('resize_scroll.xdsoft_scroller',function( event,_percent,noTriggerScroll ) {\r\n\t\t\t\t\t\tparentHeight = timeboxparent[0].clientHeight;\r\n\t\t\t\t\t\theight = timebox[0].offsetHeight;\r\n\t\t\t\t\t\tvar percent = parentHeight/height,\r\n\t\t\t\t\t\t\tsh = percent*scrollbar[0].offsetHeight;\r\n\t\t\t\t\t\tif( percent>1 )\r\n\t\t\t\t\t\t\tscroller.hide();\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tscroller.show();\r\n\t\t\t\t\t\t\tscroller.css('height',parseInt(sh>10?sh:10));\r\n\t\t\t\t\t\t\tmaximumOffset = scrollbar[0].offsetHeight-scroller[0].offsetHeight;\r\n\t\t\t\t\t\t\tif( noTriggerScroll!==true )\r\n\t\t\t\t\t\t\t\ttimeboxparent.trigger('scroll_element.xdsoft_scroller',[_percent?_percent:Math.abs(parseInt(timebox.css('marginTop')))/(height-parentHeight)]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\ttimeboxparent.mousewheel&&timeboxparent.mousewheel(function(event, delta, deltaX, deltaY) {\r\n\t\t\t\t\tvar top = Math.abs(parseInt(timebox.css('marginTop')));\r\n\t\t\t\t\ttimeboxparent.trigger('scroll_element.xdsoft_scroller',[(top-delta*20)/(height-parentHeight)]);\r\n\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t});\r\n\t\t\t\ttimeboxparent.on('touchstart',function( event ) {\r\n\t\t\t\t\tstart = pointerEventToXY(event);\r\n\t\t\t\t});\r\n\t\t\t\ttimeboxparent.on('touchmove',function( event ) {\r\n\t\t\t\t\tif( start ) {\r\n\t\t\t\t\t\tvar coord = pointerEventToXY(event), top = Math.abs(parseInt(timebox.css('marginTop')));\r\n\t\t\t\t\t\ttimeboxparent.trigger('scroll_element.xdsoft_scroller',[(top-(coord.y-start.y))/(height-parentHeight)]);\r\n\t\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t};\r\n\t\t\t\t});\r\n\t\t\t\ttimeboxparent.on('touchend touchcancel',function( event ) {\r\n\t\t\t\t\tstart = false;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\ttimeboxparent.trigger('resize_scroll.xdsoft_scroller',[_percent]);\r\n\t\t});\r\n\t};\r\n\t$.fn.datetimepicker = function( opt ) {\r\n\t\ttarget = this;\r\n\t\tvar KEY0 = 48,\r\n\t\t\tKEY9 = 57,\r\n\t\t\t_KEY0 = 96,\r\n\t\t\t_KEY9 = 105,\r\n\t\t\tCTRLKEY = 17,\r\n\t\t\tDEL = 46,\r\n\t\t\tENTER = 13,\r\n\t\t\tESC = 27,\r\n\t\t\tBACKSPACE = 8,\r\n\t\t\tARROWLEFT = 37,\r\n\t\t\tARROWUP = 38,\r\n\t\t\tARROWRIGHT = 39,\r\n\t\t\tARROWDOWN = 40,\r\n\t\t\tTAB = 9,\r\n\t\t\tF5 = 116,\r\n\t\t\tAKEY = 65,\r\n\t\t\tCKEY = 67,\r\n\t\t\tVKEY = 86,\r\n\t\t\tZKEY = 90,\r\n\t\t\tYKEY = 89,\r\n\t\t\tctrlDown\t=\tfalse,\r\n\t\t\toptions = ($.isPlainObject(opt)||!opt)?$.extend(true,{},default_options,opt):$.extend({},default_options),\r\n\t\t\tcreateDateTimePicker = function( input ) {\r\n\t\t\t\tvar datetimepicker = $('<div '+(options.id?'id=\"'+options.id+'\"':'')+' '+(options.style?'style=\"'+options.style+'\"':'')+' class=\"xdsoft_datetimepicker xdsoft_noselect '+options.className+'\"></div>'),\r\n\t\t\t\t\txdsoft_copyright = $('<div class=\"xdsoft_copyright\"><a target=\"_blank\" href=\"http://xdsoft.net/jqplugins/datetimepicker/\">xdsoft.net</a></div>'),\r\n\t\t\t\t\tdatepicker = $('<div class=\"xdsoft_datepicker active\"></div>'),\r\n\t\t\t\t\tmounth_picker = $('<div class=\"xdsoft_mounthpicker\"><button type=\"button\" class=\"xdsoft_prev\"></button><button type=\"button\" class=\"xdsoft_today_button\"></button><div class=\"xdsoft_label xdsoft_month\"><span></span></div><div class=\"xdsoft_label xdsoft_year\"><span></span></div><button type=\"button\" class=\"xdsoft_next\"></button></div>'),\r\n\t\t\t\t\tcalendar = $('<div class=\"xdsoft_calendar\"></div>'),\r\n\t\t\t\t\ttimepicker = $('<div class=\"xdsoft_timepicker active\"><button type=\"button\" class=\"xdsoft_prev\"></button><div class=\"xdsoft_time_box\"></div><button type=\"button\" class=\"xdsoft_next\"></button></div>'),\r\n\t\t\t\t\ttimeboxparent = timepicker.find('.xdsoft_time_box').eq(0),\r\n\t\t\t\t\ttimebox = $('<div class=\"xdsoft_time_variant\"></div>'),\r\n\t\t\t\t\tscrollbar = $('<div class=\"xdsoft_scrollbar\"></div>'),\r\n\t\t\t\t\tscroller = $('<div class=\"xdsoft_scroller\"></div>'),\r\n\t\t\t\t\tmonthselect =$('<div class=\"xdsoft_select xdsoft_monthselect\"><div></div></div>'),\r\n\t\t\t\t\tyearselect =$('<div class=\"xdsoft_select xdsoft_yearselect\"><div></div></div>');\r\n\r\n\t\t\t\t//constructor lego\r\n\t\t\t\tmounth_picker\r\n\t\t\t\t\t.find('.xdsoft_month span')\r\n\t\t\t\t\t\t.after(monthselect);\r\n\t\t\t\tmounth_picker\r\n\t\t\t\t\t.find('.xdsoft_year span')\r\n\t\t\t\t\t\t.after(yearselect);\r\n\r\n\t\t\t\tmounth_picker\r\n\t\t\t\t\t.find('.xdsoft_month,.xdsoft_year')\r\n\t\t\t\t\t\t.on('mousedown.xdsoft',function(event) {\r\n\t\t\t\t\t\t\tmounth_picker\r\n\t\t\t\t\t\t\t\t.find('.xdsoft_select')\r\n\t\t\t\t\t\t\t\t\t.hide();\r\n\t\t\t\t\t\t\tvar select = $(this).find('.xdsoft_select').eq(0),\r\n\t\t\t\t\t\t\t\tval = 0,\r\n\t\t\t\t\t\t\t\ttop = 0;\r\n\r\n\t\t\t\t\t\t\tif( _xdsoft_datetime.currentTime )\r\n\t\t\t\t\t\t\t\tval = _xdsoft_datetime.currentTime[$(this).hasClass('xdsoft_month')?'getMonth':'getFullYear']();\r\n\r\n\t\t\t\t\t\t\tselect.show();\r\n\t\t\t\t\t\t\tfor(var items = select.find('div.xdsoft_option'),i = 0;i<items.length;i++) {\r\n\t\t\t\t\t\t\t\tif( items.eq(i).data('value')==val ) {\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}else top+=items[0].offsetHeight;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tselect.xdsoftScroller(top/(select.children()[0].offsetHeight-(select[0].clientHeight)));\r\n\t\t\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\tmounth_picker\r\n\t\t\t\t\t.find('.xdsoft_select')\r\n\t\t\t\t\t\t.xdsoftScroller()\r\n\t\t\t\t\t\t.on('mousedown.xdsoft',function( event ) {\r\n\t\t\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.on('mousedown.xdsoft','.xdsoft_option',function( event ) {\r\n\t\t\t\t\t\t\tif( _xdsoft_datetime&&_xdsoft_datetime.currentTime )\r\n\t\t\t\t\t\t\t\t_xdsoft_datetime.currentTime[$(this).parent().parent().hasClass('xdsoft_monthselect')?'setMonth':'setFullYear']($(this).data('value'));\r\n\t\t\t\t\t\t\t$(this).parent().parent().hide();\r\n\t\t\t\t\t\t\tdatetimepicker.trigger('xchange.xdsoft');\r\n\t\t\t\t\t\t\toptions.onChangeMonth&&options.onChangeMonth.call&&options.onChangeMonth.call(datetimepicker,_xdsoft_datetime.currentTime,datetimepicker.data('input'));\r\n\t\t\t\t\t\t});\r\n\r\n\r\n\t\t\t\t// set options\r\n\t\t\t\tdatetimepicker.setOptions = function( _options ) {\r\n\t\t\t\t\toptions = $.extend(true,{},options,_options);\r\n\t\t\t\t\tif( (options.open||options.opened)&&(!options.inline) ) {\r\n\t\t\t\t\t\tinput.trigger('open.xdsoft');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif( options.inline ) {\r\n\t\t\t\t\t\tdatetimepicker.addClass('xdsoft_inline');\r\n\t\t\t\t\t\tinput.after(datetimepicker).hide();\r\n\t\t\t\t\t\tdatetimepicker.trigger('afterOpen.xdsoft');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif( options.inverseButton ) {\r\n\t\t\t\t\t\toptions.next = 'xdsoft_prev';\r\n\t\t\t\t\t\toptions.prev = 'xdsoft_next';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif( options.datepicker )\r\n\t\t\t\t\t\tdatepicker.addClass('active');\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tdatepicker.removeClass('active');\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tif( options.timepicker )\r\n\t\t\t\t\t\ttimepicker.addClass('active');\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\ttimepicker.removeClass('active');\r\n\r\n\t\t\t\t\tif( options.value ){\r\n\t\t\t\t\t\tinput&&input.val&&input.val(options.value);\r\n\t\t\t\t\t\t_xdsoft_datetime.setCurrentTime(options.value);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif( isNaN(options.dayOfWeekStart)||parseInt(options.dayOfWeekStart)<0||parseInt(options.dayOfWeekStart)>6 )\r\n\t\t\t\t\t\toptions.dayOfWeekStart = 0;\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\toptions.dayOfWeekStart = parseInt(options.dayOfWeekStart);\r\n\r\n\t\t\t\t\tif( !options.timepickerScrollbar )\r\n\t\t\t\t\t\tscrollbar.hide();\r\n\r\n\t\t\t\t\tvar tmpDate = [],timeOffset;\r\n\t\t\t\t\tif( options.minDate && ( tmpDate = /^-(.*)$/.exec(options.minDate) ) && (tmpDate=Date.parseDate(tmpDate[1], options.formatDate)) ) {\r\n\t\t\t\t\t\ttimeOffset = tmpDate.getTime()+-1*(tmpDate.getTimezoneOffset())*60000;\r\n\t\t\t\t\t\toptions.minDate = new Date((_xdsoft_datetime.now()).getTime()-timeOffset).dateFormat( options.formatDate );\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif( options.maxDate && ( tmpDate = /^\\+(.*)$/.exec(options.maxDate) ) && (tmpDate=Date.parseDate(tmpDate[1], options.formatDate)) ) {\r\n\t\t\t\t\t\ttimeOffset = tmpDate.getTime()+-1*(tmpDate.getTimezoneOffset())*60000;\r\n\t\t\t\t\t\toptions.maxDate = new Date((_xdsoft_datetime.now()).getTime()+timeOffset).dateFormat( options.formatDate );\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tmounth_picker\r\n\t\t\t\t\t\t.find('.xdsoft_today_button')\r\n\t\t\t\t\t\t\t.css('visibility',!options.todayButton?'hidden':'visible');\r\n\r\n\t\t\t\t\tif( options.mask ) {\r\n\t\t\t\t\t\tvar e,\r\n\t\t\t\t\t\t\tgetCaretPos = function ( input ) {\r\n\t\t\t\t\t\t\t\ttry{\r\n\t\t\t\t\t\t\t\t\tif ( document.selection && document.selection.createRange ) {\r\n\t\t\t\t\t\t\t\t\t\tvar range = document.selection.createRange();\r\n\t\t\t\t\t\t\t\t\t\treturn range.getBookmark().charCodeAt(2) - 2;\r\n\t\t\t\t\t\t\t\t\t}else\r\n\t\t\t\t\t\t\t\t\t\tif ( input.setSelectionRange )\r\n\t\t\t\t\t\t\t\t\t\t\treturn input.selectionStart;\r\n\t\t\t\t\t\t\t\t}catch(e) {\r\n\t\t\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tsetCaretPos = function ( node,pos ) {\r\n\t\t\t\t\t\t\t\tvar node = (typeof node == \"string\" || node instanceof String) ? document.getElementById(node) : node;\r\n\t\t\t\t\t\t\t\tif(!node) {\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}else if(node.createTextRange) {\r\n\t\t\t\t\t\t\t\t\tvar textRange = node.createTextRange();\r\n\t\t\t\t\t\t\t\t\ttextRange.collapse(true);\r\n\t\t\t\t\t\t\t\t\ttextRange.moveEnd(pos);\r\n\t\t\t\t\t\t\t\t\ttextRange.moveStart(pos);\r\n\t\t\t\t\t\t\t\t\ttextRange.select();\r\n\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t}else if(node.setSelectionRange) {\r\n\t\t\t\t\t\t\t\t\tnode.setSelectionRange(pos,pos);\r\n\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tisValidValue = function ( mask,value ) {\r\n\t\t\t\t\t\t\t\tvar reg = mask\r\n\t\t\t\t\t\t\t\t\t.replace(/([\\[\\]\\/\\{\\}\\(\\)\\-\\.\\+]{1})/g,'\\\\$1')\r\n\t\t\t\t\t\t\t\t\t.replace(/_/g,'{digit+}')\r\n\t\t\t\t\t\t\t\t\t.replace(/([0-9]{1})/g,'{digit$1}')\r\n\t\t\t\t\t\t\t\t\t.replace(/\\{digit([0-9]{1})\\}/g,'[0-$1_]{1}')\r\n\t\t\t\t\t\t\t\t\t.replace(/\\{digit[\\+]\\}/g,'[0-9_]{1}');\r\n\t\t\t\t\t\t\t\treturn RegExp(reg).test(value);\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\tinput.off('keydown.xdsoft');\r\n\t\t\t\t\t\tswitch(true) {\r\n\t\t\t\t\t\t\tcase ( options.mask===true ):\r\n\t\t\t\t\t\t\t\t//options.mask = (new Date()).dateFormat( options.format );\r\n\t\t\t\t\t\t\t\t//options.mask = options.mask.replace(/[0-9]/g,'_');\r\n\t\t\t\t\t\t\t\toptions.mask = options.format\r\n\t\t\t\t\t\t\t\t\t.replace(/Y/g,'9999')\r\n\t\t\t\t\t\t\t\t\t.replace(/F/g,'9999')\r\n\t\t\t\t\t\t\t\t\t.replace(/m/g,'19')\r\n\t\t\t\t\t\t\t\t\t.replace(/d/g,'39')\r\n\t\t\t\t\t\t\t\t\t.replace(/H/g,'29')\r\n\t\t\t\t\t\t\t\t\t.replace(/i/g,'59')\r\n\t\t\t\t\t\t\t\t\t.replace(/s/g,'59');\r\n\t\t\t\t\t\t\tcase ( $.type(options.mask) == 'string' ):\r\n\t\t\t\t\t\t\t\tif( !isValidValue( options.mask,input.val() ) )\r\n\t\t\t\t\t\t\t\t\tinput.val(options.mask.replace(/[0-9]/g,'_'));\r\n\r\n\t\t\t\t\t\t\t\tinput.on('keydown.xdsoft',function( event ) {\r\n\t\t\t\t\t\t\t\t\tvar val = this.value,\r\n\t\t\t\t\t\t\t\t\t\tkey = event.which;\r\n\t\t\t\t\t\t\t\t\tswitch(true) {\r\n\t\t\t\t\t\t\t\t\t\tcase (( key>=KEY0&&key<=KEY9 )||( key>=_KEY0&&key<=_KEY9 ))||(key==BACKSPACE||key==DEL):\r\n\t\t\t\t\t\t\t\t\t\t\tvar pos = getCaretPos(this),\r\n\t\t\t\t\t\t\t\t\t\t\t\tdigit = ( key!=BACKSPACE&&key!=DEL )?String.fromCharCode((_KEY0 <= key && key <= _KEY9)? key-KEY0 : key):'_';\r\n\t\t\t\t\t\t\t\t\t\t\tif( (key==BACKSPACE||key==DEL)&&pos ) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tpos--;\r\n\t\t\t\t\t\t\t\t\t\t\t\tdigit='_';\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\twhile( /[^0-9_]/.test(options.mask.substr(pos,1))&&pos<options.mask.length&&pos>0 )\r\n\t\t\t\t\t\t\t\t\t\t\t\tpos+=( key==BACKSPACE||key==DEL )?-1:1;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tval = val.substr(0,pos)+digit+val.substr(pos+1);\r\n\t\t\t\t\t\t\t\t\t\t\tif( $.trim(val)=='' )\r\n\t\t\t\t\t\t\t\t\t\t\t\tval = options.mask.replace(/[0-9]/g,'_');\r\n\t\t\t\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\t\t\t\tif( pos==options.mask.length )\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tpos+=(key==BACKSPACE||key==DEL)?0:1;\r\n\t\t\t\t\t\t\t\t\t\t\twhile( /[^0-9_]/.test(options.mask.substr(pos,1))&&pos<options.mask.length&&pos>0 )\r\n\t\t\t\t\t\t\t\t\t\t\t\tpos+=(key==BACKSPACE||key==DEL)?-1:1;\r\n\t\t\t\t\t\t\t\t\t\t\tif( isValidValue( options.mask,val ) ) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.value = val;\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetCaretPos(this,pos);\r\n\t\t\t\t\t\t\t\t\t\t\t}else if( $.trim(val)=='' )\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.value = options.mask.replace(/[0-9]/g,'_');\r\n\t\t\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\t\t\tinput.trigger('error_input.xdsoft');\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\tcase ( !!~([AKEY,CKEY,VKEY,ZKEY,YKEY].indexOf(key))&&ctrlDown ):\r\n\t\t\t\t\t\t\t\t\t\t case !!~([ESC,ARROWUP,ARROWDOWN,ARROWLEFT,ARROWRIGHT,F5,CTRLKEY,TAB,ENTER].indexOf(key)):\r\n\t\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif( options.validateOnBlur ) {\r\n\t\t\t\t\t\tinput\r\n\t\t\t\t\t\t\t.off('blur.xdsoft')\r\n\t\t\t\t\t\t\t.on('blur.xdsoft', function() {\r\n\t\t\t\t\t\t\t\tif( options.allowBlank && !$.trim($(this).val()).length ) {\r\n\t\t\t\t\t\t\t\t\t$(this).val(null);\r\n\t\t\t\t\t\t\t\t\tdatetimepicker.data('xdsoft_datetime').empty();\r\n\t\t\t\t\t\t\t\t}else if( !Date.parseDate( $(this).val(), options.format ) ) {\r\n\t\t\t\t\t\t\t\t\t$(this).val((_xdsoft_datetime.now()).dateFormat( options.format ));\r\n\t\t\t\t\t\t\t\t\tdatetimepicker.data('xdsoft_datetime').setCurrentTime($(this).val());\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tdatetimepicker.data('xdsoft_datetime').setCurrentTime($(this).val());\r\n \t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tdatetimepicker.trigger('changedatetime.xdsoft');\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\toptions.dayOfWeekStartPrev = (options.dayOfWeekStart==0)?6:options.dayOfWeekStart-1;\r\n\t\t\t\t\tdatetimepicker\r\n\t\t\t\t\t\t.trigger('xchange.xdsoft');\r\n\t\t\t\t};\r\n\r\n\t\t\t\tdatetimepicker\r\n\t\t\t\t\t.data('options',options)\r\n\t\t\t\t\t.on('mousedown.xdsoft',function( event ) {\r\n\t\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\tyearselect.hide();\r\n\t\t\t\t\t\tmonthselect.hide();\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\tvar scroll_element = timepicker.find('.xdsoft_time_box');\r\n\t\t\t\tscroll_element.append(timebox);\r\n\t\t\t\tscroll_element.xdsoftScroller();\r\n\t\t\t\tdatetimepicker.on('afterOpen.xdsoft',function() {\r\n\t\t\t\t\tscroll_element.xdsoftScroller();\r\n\t\t\t\t});\r\n\r\n\t\t\t\tdatetimepicker\r\n\t\t\t\t\t.append(datepicker)\r\n\t\t\t\t\t.append(timepicker);\r\n\r\n\t\t\t\tif( options.withoutCopyright!==true )\r\n\t\t\t\t\tdatetimepicker\r\n\t\t\t\t\t\t.append(xdsoft_copyright);\r\n\r\n\t\t\t\tdatepicker\r\n\t\t\t\t\t.append(mounth_picker)\r\n\t\t\t\t\t.append(calendar);\r\n\r\n\t\t\t\t$('body').append(datetimepicker);\r\n\r\n\t\t\t\tvar _xdsoft_datetime = new function() {\r\n\t\t\t\t\tvar _this = this;\r\n\t\t\t\t\t_this.now = function() {\r\n\t\t\t\t\t\tvar d = new Date();\r\n\t\t\t\t\t\tif( options.yearOffset )\r\n\t\t\t\t\t\t\td.setFullYear(d.getFullYear()+options.yearOffset);\r\n\t\t\t\t\t\treturn d;\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t_this.currentTime = this.now();\r\n\t\t\t\t\t_this.isValidDate = function (d) {\r\n\t\t\t\t\t\tif ( Object.prototype.toString.call(d) !== \"[object Date]\" )\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\treturn !isNaN(d.getTime());\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t_this.setCurrentTime = function( dTime) {\r\n\t\t\t\t\t\t_this.currentTime = (typeof dTime == 'string')? _this.strtodatetime(dTime) : _this.isValidDate(dTime) ? dTime: _this.now();\r\n\t\t\t\t\t\tdatetimepicker.trigger('xchange.xdsoft');\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t_this.empty = function() {\r\n\t\t\t\t\t\t_this.currentTime = null;\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t_this.getCurrentTime = function( dTime) {\r\n\t\t\t\t\t\treturn _this.currentTime;\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t_this.nextMonth = function() {\r\n\t\t\t\t\t\tvar month = _this.currentTime.getMonth()+1;\r\n\t\t\t\t\t\tif( month==12 ) {\r\n\t\t\t\t\t\t\t_this.currentTime.setFullYear(_this.currentTime.getFullYear()+1);\r\n\t\t\t\t\t\t\tmonth = 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_this.currentTime.setDate(\r\n\t\t\t\t\t\t\tMath.min(\r\n\t\t\t\t\t\t\t\tDate.daysInMonth[month],\r\n\t\t\t\t\t\t\t\t_this.currentTime.getDate()\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t_this.currentTime.setMonth(month);\r\n\t\t\t\t\t\toptions.onChangeMonth&&options.onChangeMonth.call&&options.onChangeMonth.call(datetimepicker,_xdsoft_datetime.currentTime,datetimepicker.data('input'));\r\n\t\t\t\t\t\tdatetimepicker.trigger('xchange.xdsoft');\r\n\t\t\t\t\t\treturn month;\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t_this.prevMonth = function() {\r\n\t\t\t\t\t\tvar month = _this.currentTime.getMonth()-1;\r\n\t\t\t\t\t\tif( month==-1 ) {\r\n\t\t\t\t\t\t\t_this.currentTime.setFullYear(_this.currentTime.getFullYear()-1);\r\n\t\t\t\t\t\t\tmonth = 11;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_this.currentTime.setDate(\r\n\t\t\t\t\t\t\tMath.min(\r\n\t\t\t\t\t\t\t\tDate.daysInMonth[month],\r\n\t\t\t\t\t\t\t\t_this.currentTime.getDate()\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t_this.currentTime.setMonth(month);\r\n\t\t\t\t\t\toptions.onChangeMonth&&options.onChangeMonth.call&&options.onChangeMonth.call(datetimepicker,_xdsoft_datetime.currentTime,datetimepicker.data('input'));\r\n\t\t\t\t\t\tdatetimepicker.trigger('xchange.xdsoft');\r\n\t\t\t\t\t\treturn month;\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t_this.strtodatetime = function( sDateTime ) {\r\n\t\t\t\t\t\tvar currentTime = sDateTime?Date.parseDate(sDateTime, options.format):_this.now();\r\n\t\t\t\t\t\tif( !_this.isValidDate(currentTime) )\r\n\t\t\t\t\t\t\tcurrentTime = _this.now();\r\n\t\t\t\t\t\treturn currentTime;\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t_this.strtodate = function( sDate ) {\r\n\t\t\t\t\t\tvar currentTime = sDate?Date.parseDate(sDate, options.formatDate):_this.now();\r\n\t\t\t\t\t\tif( !_this.isValidDate(currentTime) )\r\n\t\t\t\t\t\t\tcurrentTime = _this.now();\r\n\t\t\t\t\t\treturn currentTime;\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t_this.strtotime = function( sTime ) {\r\n\t\t\t\t\t\tvar currentTime = sTime?Date.parseDate(sTime, options.formatTime):_this.now();\r\n\t\t\t\t\t\tif( !_this.isValidDate(currentTime) )\r\n\t\t\t\t\t\t\tcurrentTime = _this.now();\r\n\t\t\t\t\t\treturn currentTime;\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t_this.str = function() {\r\n\t\t\t\t\t\treturn _this.currentTime.dateFormat(options.format);\r\n\t\t\t\t\t};\r\n\t\t\t\t};\r\n\t\t\t\tmounth_picker\r\n\t\t\t\t\t.find('.xdsoft_today_button')\r\n\t\t\t\t\t\t.on('mousedown.xdsoft',function() {\r\n\t\t\t\t\t\t\tdatetimepicker.data('changed',true);\r\n\t\t\t\t\t\t\t_xdsoft_datetime.setCurrentTime(0);\r\n\t\t\t\t\t\t\tdatetimepicker.trigger('afterOpen.xdsoft');\r\n\t\t\t\t\t\t}).on('dblclick.xdsoft',function(){\r\n\t\t\t\t\t\t\tinput.val( _xdsoft_datetime.str() );\r\n\t\t\t\t\t\t\tdatetimepicker.trigger('close.xdsoft');\r\n\t\t\t\t\t\t});\r\n\t\t\t\tmounth_picker\r\n\t\t\t\t\t.find('.xdsoft_prev,.xdsoft_next')\r\n\t\t\t\t\t\t.on('mousedown.xdsoft',function() {\r\n\t\t\t\t\t\t\tvar $this = $(this),\r\n\t\t\t\t\t\t\t\ttimer = 0,\r\n\t\t\t\t\t\t\t\tstop = false;\r\n\r\n\t\t\t\t\t\t\t(function arguments_callee1(v) {\r\n\t\t\t\t\t\t\t\tvar month =  _xdsoft_datetime.currentTime.getMonth();\r\n\t\t\t\t\t\t\t\tif( $this.hasClass( options.next ) ) {\r\n\t\t\t\t\t\t\t\t\t_xdsoft_datetime.nextMonth();\r\n\t\t\t\t\t\t\t\t}else if( $this.hasClass( options.prev ) ) {\r\n\t\t\t\t\t\t\t\t\t_xdsoft_datetime.prevMonth();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t!stop&&(timer = setTimeout(arguments_callee1,v?v:100));\r\n\t\t\t\t\t\t\t})(500);\r\n\r\n\t\t\t\t\t\t\t$([document.body,window]).on('mouseup.xdsoft',function arguments_callee2() {\r\n\t\t\t\t\t\t\t\tclearTimeout(timer);\r\n\t\t\t\t\t\t\t\tstop = true;\r\n\t\t\t\t\t\t\t\t$([document.body,window]).off('mouseup.xdsoft',arguments_callee2);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\ttimepicker\r\n\t\t\t\t\t.find('.xdsoft_prev,.xdsoft_next')\r\n\t\t\t\t\t\t.on('mousedown.xdsoft',function() {\r\n\t\t\t\t\t\t\tvar $this = $(this),\r\n\t\t\t\t\t\t\t\ttimer = 0,\r\n\t\t\t\t\t\t\t\tstop = false,\r\n\t\t\t\t\t\t\t\tperiod = 110;\r\n\t\t\t\t\t\t\t(function arguments_callee4(v) {\r\n\t\t\t\t\t\t\t\tvar pheight = timeboxparent[0].clientHeight,\r\n\t\t\t\t\t\t\t\t\theight = timebox[0].offsetHeight,\r\n\t\t\t\t\t\t\t\t\ttop = Math.abs(parseInt(timebox.css('marginTop')));\r\n\t\t\t\t\t\t\t\tif( $this.hasClass(options.next) && (height-pheight)- options.timeHeightInTimePicker>=top ) {\r\n\t\t\t\t\t\t\t\t\ttimebox.css('marginTop','-'+(top+options.timeHeightInTimePicker)+'px')\r\n\t\t\t\t\t\t\t\t}else if( $this.hasClass(options.prev) && top-options.timeHeightInTimePicker>=0  ) {\r\n\t\t\t\t\t\t\t\t\ttimebox.css('marginTop','-'+(top-options.timeHeightInTimePicker)+'px')\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\ttimeboxparent.trigger('scroll_element.xdsoft_scroller',[Math.abs(parseInt(timebox.css('marginTop'))/(height-pheight))]);\r\n\t\t\t\t\t\t\t\tperiod= ( period>10 )?10:period-10;\r\n\t\t\t\t\t\t\t\t!stop&&(timer = setTimeout(arguments_callee4,v?v:period));\r\n\t\t\t\t\t\t\t})(500);\r\n\t\t\t\t\t\t\t$([document.body,window]).on('mouseup.xdsoft',function arguments_callee5() {\r\n\t\t\t\t\t\t\t\tclearTimeout(timer);\r\n\t\t\t\t\t\t\t\tstop = true;\r\n\t\t\t\t\t\t\t\t$([document.body,window])\r\n\t\t\t\t\t\t\t\t\t.off('mouseup.xdsoft',arguments_callee5);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t// base handler - generating a calendar and timepicker\r\n\t\t\t\tdatetimepicker\r\n\t\t\t\t\t.on('xchange.xdsoft',function( event ) {\r\n\t\t\t\t\t\tvar table \t=\t'',\r\n\t\t\t\t\t\t\tstart\t= new Date(_xdsoft_datetime.currentTime.getFullYear(),_xdsoft_datetime.currentTime.getMonth(),1, 12, 0, 0),\r\n\t\t\t\t\t\t\ti = 0,\r\n\t\t\t\t\t\t\ttoday = _xdsoft_datetime.now();\r\n\t\t\t\t\t\twhile( start.getDay()!=options.dayOfWeekStart )\r\n\t\t\t\t\t\t\tstart.setDate(start.getDate()-1);\r\n\r\n\t\t\t\t\t\t//generate calendar\r\n\t\t\t\t\t\ttable+='<table><thead><tr>';\r\n\r\n\t\t\t\t\t\t// days\r\n\t\t\t\t\t\tfor(var j = 0; j<7; j++) {\r\n\t\t\t\t\t\t\ttable+='<th>'+options.i18n[options.lang].dayOfWeek[(j+options.dayOfWeekStart)>6?0:j+options.dayOfWeekStart]+'</th>';\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\ttable+='</tr></thead>';\r\n\t\t\t\t\t\ttable+='<tbody><tr>';\r\n\t\t\t\t\t\tvar maxDate = false, minDate = false;\r\n\t\t\t\t\t\tif( options.maxDate!==false ) {\r\n\t\t\t\t\t\t\tmaxDate = _xdsoft_datetime.strtodate(options.maxDate);\r\n\t\t\t\t\t\t\tmaxDate = new Date(maxDate.getFullYear(),maxDate.getMonth(),maxDate.getDate(),23,59,59,999);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif( options.minDate!==false ) {\r\n\t\t\t\t\t\t\tminDate = _xdsoft_datetime.strtodate(options.minDate);\r\n\t\t\t\t\t\t\tminDate = new Date(minDate.getFullYear(),minDate.getMonth(),minDate.getDate());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar d,y,m,classes = [];\r\n\t\t\t\t\t\twhile( i<_xdsoft_datetime.currentTime.getDaysInMonth()||start.getDay()!=options.dayOfWeekStart||_xdsoft_datetime.currentTime.getMonth()==start.getMonth() ) {\r\n\t\t\t\t\t\t\tclasses = [];\r\n\t\t\t\t\t\t\ti++;\r\n\r\n\t\t\t\t\t\t\td = start.getDate(); y = start.getFullYear(); m = start.getMonth();\r\n\r\n\t\t\t\t\t\t\tclasses.push('xdsoft_date');\r\n\r\n\t\t\t\t\t\t\tif( ( maxDate!==false && start > maxDate )||(  minDate!==false && start < minDate ) ){\r\n\t\t\t\t\t\t\t\tclasses.push('xdsoft_disabled');\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif( _xdsoft_datetime.currentTime.getMonth()!=m ) classes.push('xdsoft_other_month');\r\n\r\n\t\t\t\t\t\t\tif( (options.defaultSelect||datetimepicker.data('changed')) && _xdsoft_datetime.currentTime.dateFormat('d.m.Y')==start.dateFormat('d.m.Y') ) {\r\n\t\t\t\t\t\t\t\tclasses.push('xdsoft_current');\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif( today.dateFormat('d.m.Y')==start.dateFormat('d.m.Y') ) {\r\n\t\t\t\t\t\t\t\tclasses.push('xdsoft_today');\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif( start.getDay()==0||start.getDay()==6||~options.weekends.indexOf(start.dateFormat('d.m.Y')) ) {\r\n\t\t\t\t\t\t\t\tclasses.push('xdsoft_weekend');\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\ttable+='<td data-date=\"'+d+'\" data-month=\"'+m+'\" data-year=\"'+y+'\"'+' class=\"xdsoft_date xdsoft_day_of_week'+start.getDay()+' '+ classes.join(' ')+'\">'+\r\n\t\t\t\t\t\t\t\t\t\t'<div>'+d+'</div>'+\r\n\t\t\t\t\t\t\t\t\t'</td>';\r\n\r\n\t\t\t\t\t\t\tif( start.getDay()==options.dayOfWeekStartPrev ) {\r\n\t\t\t\t\t\t\t\ttable+='</tr>';\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tstart.setDate(d+1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttable+='</tbody></table>';\r\n\r\n\t\t\t\t\t\tcalendar.html(table);\r\n\r\n\t\t\t\t\t\tmounth_picker.find('.xdsoft_label span').eq(0).text(options.i18n[options.lang].months[_xdsoft_datetime.currentTime.getMonth()]);\r\n\t\t\t\t\t\tmounth_picker.find('.xdsoft_label span').eq(1).text(_xdsoft_datetime.currentTime.getFullYear());\r\n\r\n\t\t\t\t\t\t// generate timebox\r\n\t\t\t\t\t\tvar time = '',\r\n\t\t\t\t\t\t\th = '',\r\n\t\t\t\t\t\t\tm ='',\r\n\t\t\t\t\t\t\tline_time = function line_time( h,m ) {\r\n\t\t\t\t\t\t\t\tvar now = _xdsoft_datetime.now();\r\n\t\t\t\t\t\t\t\tnow.setHours(h);\r\n\t\t\t\t\t\t\t\th = parseInt(now.getHours());\r\n\t\t\t\t\t\t\t\tnow.setMinutes(m);\r\n\t\t\t\t\t\t\t\tm = parseInt(now.getMinutes());\r\n\r\n\t\t\t\t\t\t\t\tclasses = [];\r\n\t\t\t\t\t\t\t\tif( (options.maxTime!==false&&_xdsoft_datetime.strtotime(options.maxTime).getTime()<now.getTime())||(options.minTime!==false&&_xdsoft_datetime.strtotime(options.minTime).getTime()>now.getTime()))\r\n\t\t\t\t\t\t\t\t\tclasses.push('xdsoft_disabled');\r\n\t\t\t\t\t\t\t\tif( (options.defaultSelect||datetimepicker.data('changed')) && parseInt(_xdsoft_datetime.currentTime.getHours())==parseInt(h)&&(options.step>59||Math[options.roundTime](_xdsoft_datetime.currentTime.getMinutes()/options.step)*options.step==parseInt(m)))\r\n\t\t\t\t\t\t\t\t\tclasses.push('xdsoft_current');\r\n\t\t\t\t\t\t\t\tif( parseInt(today.getHours())==parseInt(h)&&parseInt(today.getMinutes())==parseInt(m))\r\n\t\t\t\t\t\t\t\t\tclasses.push('xdsoft_today');\r\n\t\t\t\t\t\t\t\ttime+= '<div class=\"xdsoft_time '+classes.join(' ')+'\" data-hour=\"'+h+'\" data-minute=\"'+m+'\">'+now.dateFormat(options.formatTime)+'</div>';\r\n\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tif( !options.allowTimes || !$.isArray(options.allowTimes) || !options.allowTimes.length ) {\r\n\t\t\t\t\t\t\tfor( var i=0,j=0;i<(options.hours12?12:24);i++ ) {\r\n\t\t\t\t\t\t\t\tfor( j=0;j<60;j+=options.step ) {\r\n\t\t\t\t\t\t\t\t\th = (i<10?'0':'')+i;\r\n\t\t\t\t\t\t\t\t\tm = (j<10?'0':'')+j;\r\n\t\t\t\t\t\t\t\t\tline_time( h,m );\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tfor( var i=0;i<options.allowTimes.length;i++ ) {\r\n\t\t\t\t\t\t\t\th = _xdsoft_datetime.strtotime(options.allowTimes[i]).getHours();\r\n\t\t\t\t\t\t\t\tm = _xdsoft_datetime.strtotime(options.allowTimes[i]).getMinutes();\r\n\t\t\t\t\t\t\t\tline_time( h,m );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\ttimebox.html(time);\r\n\r\n\t\t\t\t\t\tvar opt = '',\r\n\t\t\t\t\t\t\ti = 0;\r\n\r\n\t\t\t\t\t\tfor( i = parseInt(options.yearStart,10)+options.yearOffset;i<= parseInt(options.yearEnd,10)+options.yearOffset;i++ ) {\r\n\t\t\t\t\t\t\topt+='<div class=\"xdsoft_option '+(_xdsoft_datetime.currentTime.getFullYear()==i?'xdsoft_current':'')+'\" data-value=\"'+i+'\">'+i+'</div>';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tyearselect.children().eq(0)\r\n\t\t\t\t\t\t\t\t\t\t\t\t.html(opt);\r\n\r\n\t\t\t\t\t\tfor( i = 0,opt = '';i<= 11;i++ ) {\r\n\t\t\t\t\t\t\topt+='<div class=\"xdsoft_option '+(_xdsoft_datetime.currentTime.getMonth()==i?'xdsoft_current':'')+'\" data-value=\"'+i+'\">'+options.i18n[options.lang].months[i]+'</div>';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tmonthselect.children().eq(0).html(opt);\r\n\t\t\t\t\t\t$(this).trigger('generate.xdsoft');\r\n\t\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.on('afterOpen.xdsoft',function() {\r\n\t\t\t\t\t\tif( options.timepicker && timebox.find('.xdsoft_current').length ) {\r\n\t\t\t\t\t\t\tvar pheight = timeboxparent[0].clientHeight,\r\n\t\t\t\t\t\t\t\theight = timebox[0].offsetHeight,\r\n\t\t\t\t\t\t\t\ttop = timebox.find('.xdsoft_current').index()*options.timeHeightInTimePicker+1;\r\n\t\t\t\t\t\t\tif( (height-pheight)<top )\r\n\t\t\t\t\t\t\t\ttop = height-pheight;\r\n\t\t\t\t\t\t\ttimebox.css('marginTop','-'+parseInt(top)+'px');\r\n\t\t\t\t\t\t\ttimeboxparent.trigger('scroll_element.xdsoft_scroller',[parseInt(top)/(height-pheight)]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\tvar timerclick = 0;\r\n\t\t\t\tcalendar\r\n\t\t\t\t\t.on('click.xdsoft','td',function() {\r\n\t\t\t\t\t\ttimerclick++;\r\n\t\t\t\t\t\tvar $this = $(this),\r\n\t\t\t\t\t\t\tcurrentTime = _xdsoft_datetime.currentTime;\r\n\t\t\t\t\t\tif( $this.hasClass('xdsoft_disabled') )\r\n\t\t\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t\t\tcurrentTime.setFullYear( $this.data('year') );\r\n\t\t\t\t\t\tcurrentTime.setMonth( $this.data('month') );\r\n\t\t\t\t\t\tcurrentTime.setDate( $this.data('date') );\r\n\t\t\t\t\t\tdatetimepicker.trigger('select.xdsoft',[currentTime]);\r\n\r\n\t\t\t\t\t\tinput.val( _xdsoft_datetime.str() );\r\n\t\t\t\t\t\tif( (timerclick>1||(options.closeOnDateSelect===true||( options.closeOnDateSelect===0&&!options.timepicker )))&&!options.inline ) {\r\n\t\t\t\t\t\t\tdatetimepicker.trigger('close.xdsoft');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif( options.onSelectDate &&\toptions.onSelectDate.call ) {\r\n\t\t\t\t\t\t\toptions.onSelectDate.call(datetimepicker,_xdsoft_datetime.currentTime,datetimepicker.data('input'));\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdatetimepicker.data('changed',true);\r\n\t\t\t\t\t\tdatetimepicker.trigger('xchange.xdsoft');\r\n\t\t\t\t\t\tdatetimepicker.trigger('changedatetime.xdsoft');\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\ttimerclick = 0;\r\n\t\t\t\t\t\t},200);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\ttimebox\r\n\t\t\t\t\t.on('click.xdsoft','div',function() {\r\n\t\t\t\t\t\tvar $this = $(this),\r\n\t\t\t\t\t\t\tcurrentTime = _xdsoft_datetime.currentTime;\r\n\t\t\t\t\t\tif( $this.hasClass('xdsoft_disabled') )\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\tcurrentTime.setHours($this.data('hour'));\r\n\t\t\t\t\t\tcurrentTime.setMinutes($this.data('minute'));\r\n\t\t\t\t\t\tdatetimepicker.trigger('select.xdsoft',[currentTime]);\r\n\r\n\t\t\t\t\t\tdatetimepicker.data('input').val( _xdsoft_datetime.str() );\r\n\r\n\t\t\t\t\t\t!options.inline&&datetimepicker.trigger('close.xdsoft');\r\n\r\n\t\t\t\t\t\tif( options.onSelectTime&&options.onSelectTime.call ) {\r\n\t\t\t\t\t\t\toptions.onSelectTime.call(datetimepicker,_xdsoft_datetime.currentTime,datetimepicker.data('input'));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdatetimepicker.data('changed',true);\r\n\t\t\t\t\t\tdatetimepicker.trigger('xchange.xdsoft');\r\n\t\t\t\t\t\tdatetimepicker.trigger('changedatetime.xdsoft');\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\tdatetimepicker.mousewheel&&datepicker.mousewheel(function(event, delta, deltaX, deltaY) {\r\n\t\t\t\t\tif( !options.scrollMonth )\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\tif( delta<0 )\r\n\t\t\t\t\t\t_xdsoft_datetime.nextMonth();\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\t_xdsoft_datetime.prevMonth();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tdatetimepicker.mousewheel&&timeboxparent.unmousewheel().mousewheel(function(event, delta, deltaX, deltaY) {\r\n\t\t\t\t\tif( !options.scrollTime )\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\tvar pheight = timeboxparent[0].clientHeight,\r\n\t\t\t\t\t\theight = timebox[0].offsetHeight,\r\n\t\t\t\t\t\ttop = Math.abs(parseInt(timebox.css('marginTop'))),\r\n\t\t\t\t\t\tfl = true;\r\n\t\t\t\t\tif( delta<0 && (height-pheight)-options.timeHeightInTimePicker>=top ) {\r\n\t\t\t\t\t\ttimebox.css('marginTop','-'+(top+options.timeHeightInTimePicker)+'px');\r\n\t\t\t\t\t\tfl = false;\r\n\t\t\t\t\t}else if( delta>0&&top-options.timeHeightInTimePicker>=0 ) {\r\n\t\t\t\t\t\ttimebox.css('marginTop','-'+(top-options.timeHeightInTimePicker)+'px');\r\n\t\t\t\t\t\tfl = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttimeboxparent.trigger('scroll_element.xdsoft_scroller',[Math.abs(parseInt(timebox.css('marginTop'))/(height-pheight))]);\r\n\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t\treturn fl;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tdatetimepicker\r\n\t\t\t\t\t.on('changedatetime.xdsoft',function() {\r\n\t\t\t\t\t\tif( options.onChangeDateTime&&options.onChangeDateTime.call )\r\n\t\t\t\t\t\t\toptions.onChangeDateTime.call(datetimepicker,_xdsoft_datetime.currentTime,datetimepicker.data('input'));\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.on('generate.xdsoft',function() {\r\n\t\t\t\t\t\tif( options.onGenerate&&options.onGenerate.call )\r\n\t\t\t\t\t\t\toptions.onGenerate.call(datetimepicker,_xdsoft_datetime.currentTime,datetimepicker.data('input'));\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\tvar current_time_index = 0;\r\n\t\t\t\tinput.mousewheel&&input.mousewheel(function( event, delta, deltaX, deltaY ) {\r\n\t\t\t\t\tif( !options.scrollInput )\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\tif( !options.datepicker && options.timepicker ) {\r\n\t\t\t\t\t\tcurrent_time_index = timebox.find('.xdsoft_current').length?timebox.find('.xdsoft_current').eq(0).index():0;\r\n\t\t\t\t\t\tif( current_time_index+delta>=0&&current_time_index+delta<timebox.children().length )\r\n\t\t\t\t\t\t\tcurrent_time_index+=delta;\r\n\t\t\t\t\t\ttimebox.children().eq(current_time_index).length&&timebox.children().eq(current_time_index).trigger('mousedown');\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}else if( options.datepicker && !options.timepicker ) {\r\n\t\t\t\t\t\tdatepicker.trigger( event, [delta, deltaX, deltaY]);\r\n\t\t\t\t\t\tinput.val&&input.val( _xdsoft_datetime.str() );\r\n\t\t\t\t\t\tdatetimepicker.trigger('changedatetime.xdsoft');\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tvar setPos = function() {\r\n\t\t\t\t\tvar offset = datetimepicker.data('input').offset(), top = offset.top+datetimepicker.data('input')[0].offsetHeight-1, left = offset.left;\r\n\t\t\t\t\tif( top+datetimepicker[0].offsetHeight>$(window).height()+$(window).scrollTop() )\r\n\t\t\t\t\t\ttop = offset.top-datetimepicker[0].offsetHeight+1;\r\n\t\t\t\t\tif( left+datetimepicker[0].offsetWidth>$(window).width() )\r\n\t\t\t\t\t\tleft = offset.left-datetimepicker[0].offsetWidth+datetimepicker.data('input')[0].offsetWidth;\r\n\t\t\t\t\tdatetimepicker.css({\r\n\t\t\t\t\t\tleft:left,\r\n\t\t\t\t\t\ttop:top\r\n\t\t\t\t\t});\r\n\t\t\t\t};\r\n\t\t\t\tdatetimepicker\r\n\t\t\t\t\t.on('open.xdsoft', function() {\r\n\t\t\t\t\t\tvar onShow = true;\r\n\t\t\t\t\t\tif( options.onShow&&options.onShow.call) {\r\n\t\t\t\t\t\t\tonShow = options.onShow.call(datetimepicker,_xdsoft_datetime.currentTime,datetimepicker.data('input'));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif( onShow!==false ) {\r\n\t\t\t\t\t\t\tdatetimepicker.show();\r\n\t\t\t\t\t\t\tdatetimepicker.trigger('afterOpen.xdsoft');\r\n\t\t\t\t\t\t\tsetPos();\r\n\t\t\t\t\t\t\t$(window)\r\n\t\t\t\t\t\t\t\t.off('resize.xdsoft',setPos)\r\n\t\t\t\t\t\t\t\t.on('resize.xdsoft',setPos);\r\n\r\n\t\t\t\t\t\t\tif( options.closeOnWithoutClick ) {\r\n\t\t\t\t\t\t\t\t$([document.body,window]).on('mousedown.xdsoft',function arguments_callee6() {\r\n\t\t\t\t\t\t\t\t\tdatetimepicker.trigger('close.xdsoft');\r\n\t\t\t\t\t\t\t\t\t$([document.body,window]).off('mousedown.xdsoft',arguments_callee6);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.on('close.xdsoft', function( event ) {\r\n\t\t\t\t\t\tvar onClose = true;\r\n\t\t\t\t\t\tif( options.onClose&&options.onClose.call ) {\r\n\t\t\t\t\t\t\tonClose=options.onClose.call(datetimepicker,_xdsoft_datetime.currentTime,datetimepicker.data('input'));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif( onClose!==false&&!options.opened&&!options.inline ) {\r\n\t\t\t\t\t\t\tdatetimepicker.hide();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.data('input',input);\r\n\r\n\t\t\t\tvar timer = 0,\r\n\t\t\t\t\ttimer1 = 0;\r\n\r\n\t\t\t\tdatetimepicker.data('xdsoft_datetime',_xdsoft_datetime);\r\n\t\t\t\tdatetimepicker.setOptions(options);\r\n\r\n\t\t\t\tvar ct = options.value?options.value:(input&&input.val&&input.val())?input.val():'';\r\n\t\t\t\tif( ct && _xdsoft_datetime.isValidDate(ct = Date.parseDate(ct, options.format)) ) {\r\n\t\t\t\t\tdatetimepicker.data('changed',true);\r\n\t\t\t\t}else\r\n\t\t\t\t\tct = '';\r\n\r\n\t\t\t\t_xdsoft_datetime.setCurrentTime( ct?ct:0 );\r\n\r\n\t\t\t\tdatetimepicker.trigger('afterOpen.xdsoft');\r\n\r\n\t\t\t\tinput\r\n\t\t\t\t\t.data( 'xdsoft_datetimepicker',datetimepicker )\r\n\t\t\t\t\t.on('open.xdsoft focusin.xdsoft mousedown.xdsoft',function(event) {\r\n\t\t\t\t\t\tif( input.is(':disabled')||input.is(':hidden')||!input.is(':visible') )\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\tclearTimeout(timer);\r\n\t\t\t\t\t\ttimer = setTimeout(function() {\r\n\t\t\t\t\t\t\tif( input.is(':disabled')||input.is(':hidden')||!input.is(':visible') )\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t_xdsoft_datetime.setCurrentTime((input&&input.val&&input.val())?input.val():0);\r\n\t\t\t\t\t\t\tdatetimepicker.trigger('open.xdsoft');\r\n\t\t\t\t\t\t},100);\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.on('keydown.xdsoft',function( event ) {\r\n\t\t\t\t\t\tvar val = this.value,\r\n\t\t\t\t\t\t\tkey = event.which;\r\n\t\t\t\t\t\tswitch(true) {\r\n\t\t\t\t\t\t\tcase !!~([ENTER].indexOf(key)):\r\n\t\t\t\t\t\t\t\tvar elementSelector = $(\"input:visible,textarea:visible\");\r\n\t\t\t\t\t\t\t\tdatetimepicker.trigger('close.xdsoft');\r\n\t\t\t\t\t\t\t\telementSelector.eq(elementSelector.index(this) + 1).focus();\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\tcase !!~[TAB].indexOf(key):\r\n\t\t\t\t\t\t\t\tdatetimepicker.trigger('close.xdsoft');\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tdestroyDateTimePicker = function( input ) {\r\n\t\t\t\tvar datetimepicker = input.data('xdsoft_datetimepicker');\r\n\t\t\t\tif( datetimepicker ) {\r\n\t\t\t\t\tdatetimepicker.data('xdsoft_datetime',null);\r\n\t\t\t\t\tdatetimepicker.remove();\r\n\t\t\t\t\tinput\r\n\t\t\t\t\t\t.data( 'xdsoft_datetimepicker',null )\r\n\t\t\t\t\t\t.off( 'open.xdsoft focusin.xdsoft focusout.xdsoft mousedown.xdsoft blur.xdsoft keydown.xdsoft' );\r\n\t\t\t\t\t$(window).off('resize.xdsoft');\r\n\t\t\t\t\t$([window,document.body]).off('mousedown.xdsoft');\r\n\t\t\t\t\tinput.unmousewheel&&input.unmousewheel();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t$(document)\r\n\t\t\t.off('keydown.xdsoftctrl keyup.xdsoftctrl')\r\n\t\t\t.on('keydown.xdsoftctrl',function(e) {\r\n\t\t\t\tif ( e.keyCode == CTRLKEY )\r\n\t\t\t\t\tctrlDown = true;\r\n\t\t\t})\r\n\t\t\t.on('keyup.xdsoftctrl',function(e) {\r\n\t\t\t\tif ( e.keyCode == CTRLKEY )\r\n\t\t\t\t\tctrlDown = false;\r\n\t\t\t});\r\n\t\treturn this.each(function() {\r\n\t\t\tvar datetimepicker;\r\n\t\t\tif( datetimepicker = $(this).data('xdsoft_datetimepicker') ) {\r\n\t\t\t\tif( $.type(opt) === 'string' ) {\r\n\t\t\t\t\tswitch(opt) {\r\n\t\t\t\t\t\tcase 'show':\r\n\t\t\t\t\t\t\t$(this).select().focus();\r\n\t\t\t\t\t\t\tdatetimepicker.trigger( 'open.xdsoft' );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'hide':\r\n\t\t\t\t\t\t\tdatetimepicker.trigger('close.xdsoft');\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'destroy':\r\n\t\t\t\t\t\t\tdestroyDateTimePicker($(this));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'reset':\r\n\t\t\t\t\t\t\tthis.value = this.defaultValue;\r\n\t\t\t\t\t\t\tif(!this.value || !datetimepicker.data('xdsoft_datetime').isValidDate(Date.parseDate(this.value, options.format)))\r\n\t\t\t\t\t\t\t\tdatetimepicker.data('changed',false);\r\n\t\t\t\t\t\t\tdatetimepicker.data('xdsoft_datetime').setCurrentTime(this.value);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\tdatetimepicker\r\n\t\t\t\t\t\t.setOptions(opt);\r\n\t\t\t\t}\r\n\t\t\t\treturn 0;\r\n\t\t\t}else\r\n\t\t\t\t($.type(opt) !== 'string')&&createDateTimePicker($(this));\r\n\t\t});\r\n\t};\r\n})( jQuery );\r\n\r\n//http://www.xaprb.com/blog/2005/12/12/javascript-closures-for-runtime-efficiency/\r\n/*\r\n * Copyright (C) 2004 Baron Schwartz <baron at sequent dot org>\r\n *\r\n * This program is free software; you can redistribute it and/or modify it\r\n * under the terms of the GNU Lesser General Public License as published by the\r\n * Free Software Foundation, version 2.1.\r\n *\r\n * This program is distributed in the hope that it will be useful, but WITHOUT\r\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS\r\n * FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public License for more\r\n * details.\r\n */\r\nDate.parseFunctions={count:0};Date.parseRegexes=[];Date.formatFunctions={count:0};Date.prototype.dateFormat=function(format) {if(Date.formatFunctions[format]==null) {Date.createNewFormat(format)}var func=Date.formatFunctions[format];return this[func]()};Date.createNewFormat=function(format) {var funcName=\"format\"+Date.formatFunctions.count++;Date.formatFunctions[format]=funcName;var code=\"Date.prototype.\"+funcName+\" = function() {return \";var special=false;var ch='';for(var i=0;i<format.length;++i) {ch=format.charAt(i);if(!special&&ch==\"\\\\\") {special=true}else if(special) {special=false;code+=\"'\"+String.escape(ch)+\"' + \"}else{code+=Date.getFormatCode(ch)}}eval(code.substring(0,code.length-3)+\";}\")};Date.getFormatCode=function(character) {switch(character) {case\"d\":return\"String.leftPad(this.getDate(), 2, '0') + \";case\"D\":return\"Date.dayNames[this.getDay()].substring(0, 3) + \";case\"j\":return\"this.getDate() + \";case\"l\":return\"Date.dayNames[this.getDay()] + \";case\"S\":return\"this.getSuffix() + \";case\"w\":return\"this.getDay() + \";case\"z\":return\"this.getDayOfYear() + \";case\"W\":return\"this.getWeekOfYear() + \";case\"F\":return\"Date.monthNames[this.getMonth()] + \";case\"m\":return\"String.leftPad(this.getMonth() + 1, 2, '0') + \";case\"M\":return\"Date.monthNames[this.getMonth()].substring(0, 3) + \";case\"n\":return\"(this.getMonth() + 1) + \";case\"t\":return\"this.getDaysInMonth() + \";case\"L\":return\"(this.isLeapYear() ? 1 : 0) + \";case\"Y\":return\"this.getFullYear() + \";case\"y\":return\"('' + this.getFullYear()).substring(2, 4) + \";case\"a\":return\"(this.getHours() < 12 ? 'am' : 'pm') + \";case\"A\":return\"(this.getHours() < 12 ? 'AM' : 'PM') + \";case\"g\":return\"((this.getHours() %12) ? this.getHours() % 12 : 12) + \";case\"G\":return\"this.getHours() + \";case\"h\":return\"String.leftPad((this.getHours() %12) ? this.getHours() % 12 : 12, 2, '0') + \";case\"H\":return\"String.leftPad(this.getHours(), 2, '0') + \";case\"i\":return\"String.leftPad(this.getMinutes(), 2, '0') + \";case\"s\":return\"String.leftPad(this.getSeconds(), 2, '0') + \";case\"O\":return\"this.getGMTOffset() + \";case\"T\":return\"this.getTimezone() + \";case\"Z\":return\"(this.getTimezoneOffset() * -60) + \";default:return\"'\"+String.escape(character)+\"' + \"}};Date.parseDate=function(input,format) {if(Date.parseFunctions[format]==null) {Date.createParser(format)}var func=Date.parseFunctions[format];return Date[func](input)};Date.createParser=function(format) {var funcName=\"parse\"+Date.parseFunctions.count++;var regexNum=Date.parseRegexes.length;var currentGroup=1;Date.parseFunctions[format]=funcName;var code=\"Date.\"+funcName+\" = function(input) {\\n\"+\"var y = -1, m = -1, d = -1, h = -1, i = -1, s = -1;\\n\"+\"var d = new Date();\\n\"+\"y = d.getFullYear();\\n\"+\"m = d.getMonth();\\n\"+\"d = d.getDate();\\n\"+\"var results = input.match(Date.parseRegexes[\"+regexNum+\"]);\\n\"+\"if (results && results.length > 0) {\";var regex=\"\";var special=false;var ch='';for(var i=0;i<format.length;++i) {ch=format.charAt(i);if(!special&&ch==\"\\\\\") {special=true}else if(special) {special=false;regex+=String.escape(ch)}else{obj=Date.formatCodeToRegex(ch,currentGroup);currentGroup+=obj.g;regex+=obj.s;if(obj.g&&obj.c) {code+=obj.c}}}code+=\"if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0 && s >= 0)\\n\"+\"{return new Date(y, m, d, h, i, s);}\\n\"+\"else if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0)\\n\"+\"{return new Date(y, m, d, h, i);}\\n\"+\"else if (y > 0 && m >= 0 && d > 0 && h >= 0)\\n\"+\"{return new Date(y, m, d, h);}\\n\"+\"else if (y > 0 && m >= 0 && d > 0)\\n\"+\"{return new Date(y, m, d);}\\n\"+\"else if (y > 0 && m >= 0)\\n\"+\"{return new Date(y, m);}\\n\"+\"else if (y > 0)\\n\"+\"{return new Date(y);}\\n\"+\"}return null;}\";Date.parseRegexes[regexNum]=new RegExp(\"^\"+regex+\"$\");eval(code)};Date.formatCodeToRegex=function(character,currentGroup) {switch(character) {case\"D\":return{g:0,c:null,s:\"(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\"};case\"j\":case\"d\":return{g:1,c:\"d = parseInt(results[\"+currentGroup+\"], 10);\\n\",s:\"(\\\\d{1,2})\"};case\"l\":return{g:0,c:null,s:\"(?:\"+Date.dayNames.join(\"|\")+\")\"};case\"S\":return{g:0,c:null,s:\"(?:st|nd|rd|th)\"};case\"w\":return{g:0,c:null,s:\"\\\\d\"};case\"z\":return{g:0,c:null,s:\"(?:\\\\d{1,3})\"};case\"W\":return{g:0,c:null,s:\"(?:\\\\d{2})\"};case\"F\":return{g:1,c:\"m = parseInt(Date.monthNumbers[results[\"+currentGroup+\"].substring(0, 3)], 10);\\n\",s:\"(\"+Date.monthNames.join(\"|\")+\")\"};case\"M\":return{g:1,c:\"m = parseInt(Date.monthNumbers[results[\"+currentGroup+\"]], 10);\\n\",s:\"(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\"};case\"n\":case\"m\":return{g:1,c:\"m = parseInt(results[\"+currentGroup+\"], 10) - 1;\\n\",s:\"(\\\\d{1,2})\"};case\"t\":return{g:0,c:null,s:\"\\\\d{1,2}\"};case\"L\":return{g:0,c:null,s:\"(?:1|0)\"};case\"Y\":return{g:1,c:\"y = parseInt(results[\"+currentGroup+\"], 10);\\n\",s:\"(\\\\d{4})\"};case\"y\":return{g:1,c:\"var ty = parseInt(results[\"+currentGroup+\"], 10);\\n\"+\"y = ty > Date.y2kYear ? 1900 + ty : 2000 + ty;\\n\",s:\"(\\\\d{1,2})\"};case\"a\":return{g:1,c:\"if (results[\"+currentGroup+\"] == 'am') {\\n\"+\"if (h == 12) { h = 0; }\\n\"+\"} else { if (h < 12) { h += 12; }}\",s:\"(am|pm)\"};case\"A\":return{g:1,c:\"if (results[\"+currentGroup+\"] == 'AM') {\\n\"+\"if (h == 12) { h = 0; }\\n\"+\"} else { if (h < 12) { h += 12; }}\",s:\"(AM|PM)\"};case\"g\":case\"G\":case\"h\":case\"H\":return{g:1,c:\"h = parseInt(results[\"+currentGroup+\"], 10);\\n\",s:\"(\\\\d{1,2})\"};case\"i\":return{g:1,c:\"i = parseInt(results[\"+currentGroup+\"], 10);\\n\",s:\"(\\\\d{2})\"};case\"s\":return{g:1,c:\"s = parseInt(results[\"+currentGroup+\"], 10);\\n\",s:\"(\\\\d{2})\"};case\"O\":return{g:0,c:null,s:\"[+-]\\\\d{4}\"};case\"T\":return{g:0,c:null,s:\"[A-Z]{3}\"};case\"Z\":return{g:0,c:null,s:\"[+-]\\\\d{1,5}\"};default:return{g:0,c:null,s:String.escape(character)}}};Date.prototype.getTimezone=function() {return this.toString().replace(/^.*? ([A-Z]{3}) [0-9]{4}.*$/,\"$1\").replace(/^.*?\\(([A-Z])[a-z]+ ([A-Z])[a-z]+ ([A-Z])[a-z]+\\)$/,\"$1$2$3\")};Date.prototype.getGMTOffset=function() {return(this.getTimezoneOffset()>0?\"-\":\"+\")+String.leftPad(Math.floor(Math.abs(this.getTimezoneOffset())/60),2,\"0\")+String.leftPad(Math.abs(this.getTimezoneOffset())%60,2,\"0\")};Date.prototype.getDayOfYear=function() {var num=0;Date.daysInMonth[1]=this.isLeapYear()?29:28;for(var i=0;i<this.getMonth();++i) {num+=Date.daysInMonth[i]}return num+this.getDate()-1};Date.prototype.getWeekOfYear=function() {var now=this.getDayOfYear()+(4-this.getDay());var jan1=new Date(this.getFullYear(),0,1);var then=(7-jan1.getDay()+4);document.write(then);return String.leftPad(((now-then)/7)+1,2,\"0\")};Date.prototype.isLeapYear=function() {var year=this.getFullYear();return((year&3)==0&&(year%100||(year%400==0&&year)))};Date.prototype.getFirstDayOfMonth=function() {var day=(this.getDay()-(this.getDate()-1))%7;return(day<0)?(day+7):day};Date.prototype.getLastDayOfMonth=function() {var day=(this.getDay()+(Date.daysInMonth[this.getMonth()]-this.getDate()))%7;return(day<0)?(day+7):day};Date.prototype.getDaysInMonth=function() {Date.daysInMonth[1]=this.isLeapYear()?29:28;return Date.daysInMonth[this.getMonth()]};Date.prototype.getSuffix=function() {switch(this.getDate()) {case 1:case 21:case 31:return\"st\";case 2:case 22:return\"nd\";case 3:case 23:return\"rd\";default:return\"th\"}};String.escape=function(string) {return string.replace(/('|\\\\)/g,\"\\\\$1\")};String.leftPad=function(val,size,ch) {var result=new String(val);if(ch==null) {ch=\" \"}while(result.length<size) {result=ch+result}return result};Date.daysInMonth=[31,28,31,30,31,30,31,31,30,31,30,31];Date.monthNames=[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"];Date.dayNames=[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"];Date.y2kYear=50;Date.monthNumbers={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11};Date.patterns={ISO8601LongPattern:\"Y-m-d H:i:s\",ISO8601ShortPattern:\"Y-m-d\",ShortDatePattern:\"n/j/Y\",LongDatePattern:\"l, F d, Y\",FullDateTimePattern:\"l, F d, Y g:i:s A\",MonthDayPattern:\"F d\",ShortTimePattern:\"g:i A\",LongTimePattern:\"g:i:s A\",SortableDateTimePattern:\"Y-m-d\\\\TH:i:s\",UniversalSortableDateTimePattern:\"Y-m-d H:i:sO\",YearMonthPattern:\"F, Y\"};\r\n\r\n//https://github.com/brandonaaron/jquery-mousewheel/blob/master/jquery.mousewheel.js\r\n/*\r\n * Copyright (c) 2013 Brandon Aaron (http://brandonaaron.net)\r\n *\r\n * Licensed under the MIT License (LICENSE.txt).\r\n *\r\n * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.\r\n * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.\r\n * Thanks to: Seamus Leahy for adding deltaX and deltaY\r\n *\r\n * Version: 3.1.3\r\n *\r\n * Requires: 1.2.2+\r\n */\r\n(function(factory) {if(typeof define==='function'&&define.amd) {define(['jquery'],factory)}else if(typeof exports==='object') {module.exports=factory}else{factory(jQuery)}}(function($) {var toFix=['wheel','mousewheel','DOMMouseScroll','MozMousePixelScroll'];var toBind='onwheel'in document||document.documentMode>=9?['wheel']:['mousewheel','DomMouseScroll','MozMousePixelScroll'];var lowestDelta,lowestDeltaXY;if($.event.fixHooks) {for(var i=toFix.length;i;) {$.event.fixHooks[toFix[--i]]=$.event.mouseHooks}}$.event.special.mousewheel={setup:function() {if(this.addEventListener) {for(var i=toBind.length;i;) {this.addEventListener(toBind[--i],handler,false)}}else{this.onmousewheel=handler}},teardown:function() {if(this.removeEventListener) {for(var i=toBind.length;i;) {this.removeEventListener(toBind[--i],handler,false)}}else{this.onmousewheel=null}}};$.fn.extend({mousewheel:function(fn) {return fn?this.bind(\"mousewheel\",fn):this.trigger(\"mousewheel\")},unmousewheel:function(fn) {return this.unbind(\"mousewheel\",fn)}});function handler(event) {var orgEvent=event||window.event,args=[].slice.call(arguments,1),delta=0,deltaX=0,deltaY=0,absDelta=0,absDeltaXY=0,fn;event=$.event.fix(orgEvent);event.type=\"mousewheel\";if(orgEvent.wheelDelta) {delta=orgEvent.wheelDelta}if(orgEvent.detail) {delta=orgEvent.detail*-1}if(orgEvent.deltaY) {deltaY=orgEvent.deltaY*-1;delta=deltaY}if(orgEvent.deltaX) {deltaX=orgEvent.deltaX;delta=deltaX*-1}if(orgEvent.wheelDeltaY!==undefined) {deltaY=orgEvent.wheelDeltaY}if(orgEvent.wheelDeltaX!==undefined) {deltaX=orgEvent.wheelDeltaX*-1}absDelta=Math.abs(delta);if(!lowestDelta||absDelta<lowestDelta) {lowestDelta=absDelta}absDeltaXY=Math.max(Math.abs(deltaY),Math.abs(deltaX));if(!lowestDeltaXY||absDeltaXY<lowestDeltaXY) {lowestDeltaXY=absDeltaXY}fn=delta>0?'floor':'ceil';delta=Math[fn](delta/lowestDelta);deltaX=Math[fn](deltaX/lowestDeltaXY);deltaY=Math[fn](deltaY/lowestDeltaXY);args.unshift(event,delta,deltaX,deltaY);return($.event.dispatch||$.event.handle).apply(this,args)}}));\r\n","/**\r\n * Created by summer on 2016/11/21.\r\n */\r\n;(function () {\r\n    orderApp.directive(\"datetimepicker\",function(){\r\n        return {\r\n            restrict: \"EA\",\r\n            require : \"ngModel\",\r\n            link: function (scope, element, attrs, ctrl) {\r\n\r\n                var unregister = scope.$watch(function(){\r\n\r\n                    $(element).append(\"<input id='date-\"+attrs.dateid+\"' style='border:none;width:100%;height:100%' \" + \"value='\"+ctrl.$modelValue+\"'>\");\r\n                    $(element).css(\"padding\",\"0\");\r\n\r\n                    element.on('change', function() {\r\n                        scope.$apply(function() {\r\n                            ctrl.$setViewValue($(\"#date-\"+attrs.dateid).val());\r\n                        });\r\n                    });\r\n\r\n                    element.on('click',function(){\r\n                        $(\"#date-\"+attrs.dateid).datetimepicker({\r\n                            format : attrs.format || 'Y/m/d h:i',\r\n                            onClose : function(){\r\n                                element.change();\r\n                            }\r\n                        });\r\n                    });\r\n\r\n                    element.click();\r\n\r\n                    return ctrl.$modelValue;\r\n                }, initialize);\r\n\r\n                function initialize(value){\r\n                    ctrl.$setViewValue(value);\r\n                    unregister();\r\n                }\r\n            }\r\n        }\r\n    });\r\n})();\r\n\r\n","/**\r\n * Created by summer on 2016/11/20.\r\n */\r\n;(function () {\r\n    'use strict';\r\n        angular.module('commonDashboard', [])\r\n            .service('CommonService',[\r\n                '$http',\r\n                '$rootScope',\r\n                '$q',\r\n                '$filter',\r\n                function ($http, $rootScope, $q, $filter) {\r\n                    var me = this;\r\n\r\n                    /*======================贯穿的个人权限============================*/\r\n                    me.PermissionsHad = {};\r\n                    me.PermissionsNameHad = {};\r\n                    me.fnGetPermissionsHad = function (userId, groupId) {\r\n                        var deffered = $q.defer();\r\n                        if(me.PermissionsHad[userId] == null) {\r\n                            $http.post(\"/user/allPermissionsHad\", {id: userId, groupId: groupId}).then(function (r) {\r\n\r\n                                if(r.status !== 200 || r.data.status !=1) {\r\n                                    deffered.reject();\r\n                                    return;\r\n                                }\r\n\r\n                                me.PermissionsHad[userId] = r.data.data.allPermissionHad;\r\n                                me.PermissionsNameHad[userId] = r.data.data.allPermissionNameHad;\r\n\r\n                                deffered.resolve(me.PermissionsHad[userId]);\r\n                            });\r\n                            return deffered.promise;\r\n                        } else {\r\n                            return $q.when(me.PermissionsHad[userId]);\r\n                        }\r\n                    };\r\n                    me.fnGetPermissionsNameHad = function (userId, groupId) {\r\n                        var deffered = $q.defer();\r\n                        if(me.PermissionsNameHad[userId] == null) {\r\n                            $http.post(\"/user/allPermissionsHad\", {id: userId, groupId: groupId}).then(function (r) {\r\n\r\n                                if(r.status !== 200 || r.data.status !=1) {\r\n                                    deffered.reject();\r\n                                    return;\r\n                                }\r\n\r\n                                me.PermissionsHad[userId] = r.data.data.allPermissionHad;\r\n                                me.PermissionsNameHad[userId] = r.data.data.allPermissionNameHad;\r\n\r\n                                deffered.resolve(me.PermissionsNameHad[userId]);\r\n                            });\r\n                            return deffered.promise;\r\n                        } else {\r\n                            return $q.when(me.PermissionsNameHad[userId]);\r\n                        }\r\n                    };\r\n\r\n                    /*=======================部门下的所有员工========================*/\r\n                    \r\n                    var usersBygroup = {};\r\n                    me.fnGetUsersBygroup = function (groupId) {\r\n                            var deffered = $q.defer();\r\n                          if (!usersBygroup[groupId]) {\r\n                              $http.get('/group/getUsers/'+groupId).then(function (r) {\r\n                                  if (r.data.status != 1) deffered.reject('status 0');\r\n                                  usersBygroup[groupId] = r.data.data;\r\n                                  deffered.resolve(r.data.data);\r\n                              });\r\n                              return deffered.promise;\r\n                          } else {\r\n                              return $q.when(usersBygroup[groupId]);\r\n                          }\r\n                    };\r\n\r\n                    //=============================常用字段的users信息\r\n                    var usersOptional = {};\r\n                    me.fnGetusersOptional = function () {\r\n                        var deffered = $q.defer();\r\n                        if (angular.equals({},usersOptional)) {\r\n                            $http.get('/user/getUserOptional/').then(function (r) {\r\n                                if (r.data.status != 1) deffered.reject('status 0');\r\n                                usersOptional = r.data.data;\r\n                                deffered.resolve(r.data.data);\r\n                            });\r\n                            return deffered.promise;\r\n                        } else {\r\n                            return $q.when(usersOptional);\r\n                        }\r\n                    };\r\n\r\n                    /*================== 公共常用的方法 ==================*/\r\n\r\n                    /**\r\n                     * $filter('filter')\r\n                     * 实际生产中直接$filter('filter')(data, filter);\r\n                     * @param data\r\n                     * @param filter\r\n                     * @returns {*}\r\n                     */\r\n                    me.filterData = function(data, filter){\r\n                        return $filter('filter')(data, filter);\r\n                    };\r\n\r\n                    //下面三种方法只针对于ngTable，params是getData传入参数\r\n                    \r\n                    /**\r\n                     * 排序\r\n                     * @param data\r\n                     * @param params\r\n                     * @returns {*}\r\n                     */\r\n                    me.orderData = function(data, params){\r\n                        return params.sorting() ? $filter('orderBy')(data, params.orderBy()) : data;\r\n                    };\r\n\r\n                    /**\r\n                     * 排序、分页数据\r\n                     * @param data\r\n                     * @param params\r\n                     * @returns {Array.<T>|*|Blob|string|ArrayBuffer}\r\n                     */\r\n                    me.sliceOrderData = function(data, params){\r\n                        return me.orderData(data, params).slice((params.page() - 1) * params.count(), params.page() * params.count())\r\n                    };\r\n\r\n                    /**\r\n                     * 返回筛选、排序、分页后的数据\r\n                     * @param data\r\n                     * @param filter\r\n                     * @param params\r\n                     * @returns {Array.<T>|*|Blob|string|ArrayBuffer}\r\n                     */\r\n                    me.transformData = function(data,filter,params){\r\n                        return me.sliceOrderData(me.filterData(data,filter), params);\r\n                    };\r\n                }\r\n            ])\r\n            //传入id，返回对应的name\r\n            .filter('zwbIdToName', function () {\r\n                return function (id, data) {\r\n                    var name=id;\r\n                    //data format [{id:1,name:'test1'},{id:1,name:'test2'}]\r\n                    angular.forEach(data, function (value, key) {\r\n                        if(value.id == id){\r\n                            name = value.name;\r\n                            return;\r\n                        }\r\n                    });\r\n                    return name;\r\n                }\r\n            })\r\n            // ng-table show fields ng-table显示与隐藏选项：except为必显示项\r\n            .filter('zwbExceptFields', function () {\r\n                return function (show, col, except) {\r\n                    // except is an array 不显示的项\r\n                    //col title\r\n                    var result = true;\r\n                    angular.forEach(except, function (value, key) {\r\n                        if(value == col) { result = false;return;}\r\n                    });\r\n                    return result;\r\n                }\r\n            })\r\n})();\r\n","/**\r\n * Created by Geek-zwb on 2016/11/19 0019.\r\n */\r\n\r\n;(function () {\r\n\r\n    'use strict';\r\n\r\n    angular.module('userDashboard', [])\r\n        .service('UserService', [\r\n            '$http',\r\n            '$state',\r\n            '$filter',\r\n            '$q',\r\n            function ($http, $state,$filter,$q) {\r\n                var me = this;\r\n                me.profileData = {};//用户信息\r\n\r\n                me.askLeaveInfo = {\r\n                    type: '事假',\r\n                    total_time: 0,\r\n                    status: false\r\n                };//一次请假\r\n\r\n                me.leavesInfo = {};\r\n\r\n                //获取用户自身信息\r\n                me.getProfile = function () {\r\n                        var deffered = $q.defer();\r\n                        if(angular.equals({}, me.profileData)) {\r\n                            $http.get(\"user/getProfile\").then(function (r) {\r\n\r\n                                if(r.status !== 200 || r.data.status !=1) {\r\n                                    deffered.reject();\r\n                                    return;\r\n                                }\r\n\r\n                                me.profileData = r.data.data['user'];\r\n                                me.profileData.password = '';\r\n\r\n                                deffered.resolve(me.profileData);\r\n                            });\r\n                            return deffered.promise;\r\n                        } else {\r\n                            return $q.when(me.profileData);\r\n                        }\r\n                };\r\n\r\n                //更新个人资料\r\n                me.profileUpdate = function () {\r\n                    $http.post('user/profileUpdate', me.profileData)\r\n                        .then(function (r) {\r\n                            if(r.data.status == 1) {\r\n                                me.profileData.updateStatus = true;\r\n                            }\r\n                        }, function (e) {\r\n                            //error\r\n                        })\r\n                };\r\n\r\n                //请假申请\r\n                me.askforLeave = function () {\r\n                    if(me.pending) return;//防止重复请求\r\n                    me.pending =true;\r\n                    console.log(me.askLeaveInfo);\r\n                    $http.post('leave', me.askLeaveInfo)\r\n                        .then(function (r) {\r\n                            if(r.data.status == 1) {\r\n                                //申请请假成功\r\n                                me.askLeaveInfo.status = true;\r\n                                setTimeout(function () {\r\n                                    me.askLeaveInfo = {};\r\n                                   // $state.go('allLeaves');\r\n                                },3000);\r\n                                // me.askLeaveInfo = {};\r\n                            } else {\r\n                                me.askLeaveInfo.err = r.data.msg;\r\n                                setTimeout(function () {\r\n                                    me.askLeaveInfo.err = null;\r\n                                },2000);\r\n                            }\r\n                        },function (e) {\r\n                            // error\r\n                        })\r\n                        .finally(function () {\r\n                            me.pending = false;\r\n                        })\r\n                }\r\n            }\r\n        ])\r\n\r\n        .service(\"LeaveService\", [\r\n            '$http',\r\n            '$filter',\r\n            '$q',\r\n            function($http, $filter,$q){\r\n                var cachedData; //请假记录\r\n\r\n                var dataLength; //后台获取的总共条数\r\n\r\n                function filterData(data, filter){\r\n                    return $filter('filter')(data, filter);\r\n                }\r\n\r\n                function orderData(data, params){\r\n                    return params.sorting() ? $filter('orderBy')(data, params.orderBy()) : filteredData;\r\n                }\r\n\r\n                function sliceData(data, params){\r\n                    return data.slice((params.page() - 1) * params.count(), params.page() * params.count())\r\n                }\r\n\r\n                function transformData(data,filter,params){\r\n                    return sliceData( orderData( filterData(data,filter), params ), params);\r\n                }\r\n\r\n                this.fnGetLeaves = function(params) {\r\n                    console.log(params.sorting());\r\n                    console.log(params.orderBy());\r\n                    var deffered = $q.defer();\r\n\r\n\r\n                    //还要加上判断chcheData中的数据够不够显示,暂缓\r\n                    if(angular.isUndefined(cachedData)) {\r\n                        $http.get(\"/leave\").then(function (r) {\r\n\r\n                            if(r.status !== 200 || r.data.status !=1) {\r\n                                deffered.reject();\r\n                                return;\r\n                            }\r\n\r\n                            dataLength = r.data.data.recordsTotal;\r\n                            params.total(dataLength);\r\n                            cachedData = r.data.data.data;\r\n                            var transformedData = sliceData(orderData(cachedData,params),params);\r\n                            console.log('cachedData', transformedData);\r\n                            deffered.resolve(transformedData);\r\n                        });\r\n                        return deffered.promise;\r\n                    } else {\r\n                        //var filteredData = filterData(cachedData,filter);\r\n                        var transformedData = sliceData(orderData(cachedData,params),params);\r\n                        console.log('realcache',transformedData);\r\n                        params.total(dataLength);\r\n                        return $q.when(transformedData);\r\n                    }\r\n                };\r\n\r\n\r\n                /*return {\r\n                    getLeaves: fnGetLeaves()\r\n                }*/\r\n        }])\r\n\r\n        //show user info\r\n        .controller('UserInfoController', [\r\n            '$scope',\r\n            'UserService',\r\n            function ($scope, UserService) {\r\n                $scope.User = UserService;\r\n                UserService.getProfile();\r\n            }\r\n        ])\r\n\r\n        //update profile\r\n        .controller('ProfileUpdateController', [\r\n            '$scope',\r\n            'UserService',\r\n            function ($scope, UserService) {\r\n                $scope.User = UserService;\r\n                UserService.getProfile();\r\n            }\r\n        ])\r\n\r\n        //请假条\r\n        .controller('AskforLeaveController', [\r\n            '$scope',\r\n            'UserService',\r\n            '$filter',\r\n            function ($scope, UserService,$filter) {\r\n                $scope.User = UserService;\r\n                /*if(UserService.profileData == null || angular.equals({}, UserService.profileData)) {\r\n                     UserService.getProfile(); //从服务器得到UserService.profileData，并不能马上用怎么办？？？？？？\r\n                }*/\r\n\r\n                //初始值\r\n                //遗留问题，当UserService.profileData 尚未加载时？？？？ 监控profileData的值？ promise解决？全局变量？\r\n               // UserService.askLeaveInfo.user_id = UserService.profileData.id;\r\n                UserService.askLeaveInfo.user_id = $scope.gUserInfo.userId;\r\n               //UserService.askLeaveInfo.supervisor_id = UserService.profileData.groups[0].supervisor_id ?UserService.profileData.groups[0].supervisor_id:1;\r\n               UserService.askLeaveInfo.supervisor_id = $scope.gUserInfo.supervisor_id;\r\n                var dateFilter = $filter('date');\r\n                UserService.askLeaveInfo.begin = dateFilter(new Date(),'yyyy/MM/dd HH:mm');\r\n                UserService.askLeaveInfo.end = dateFilter(new Date(),'yyyy/MM/dd HH:mm');\r\n\r\n                //计算请假时间\r\n                $scope.$watch(function () {\r\n                    return {\r\n                        from: UserService.askLeaveInfo.begin,\r\n                        to: UserService.askLeaveInfo.end\r\n                    };\r\n                }, function (newData, oldData) {\r\n                    var total_time = 0;\r\n                    var from = new Date(newData.from);\r\n                    var to = new Date(newData.to);\r\n                    if(from > to) {\r\n                        //结束时间需大于开始时间\r\n                        $scope.message = '结束时间需大于开始时间';\r\n                        return;\r\n                    }\r\n                    var result = getWorkDayCount(from, to);\r\n                    UserService.askLeaveInfo.total_day = result[0];\r\n                    UserService.askLeaveInfo.total_hour = result[1];\r\n                    UserService.askLeaveInfo.total_time = 9*parseInt(result[0]) + parseFloat(result[1]);\r\n                },true);\r\n\r\n                function nearlyWeeks (weekcount, end) {\r\n                    //计算end时间，周的第一天\r\n                    var overTime = new Date(end);\r\n                    var days = 0 ;\r\n                    days = (overTime.getDay() == 0 ? 7 : overTime.getDay());//overTime.getDay()为0是星期天\r\n                    var ss = (days + weekcount * 7) * 24 * 60 * 60 * 1000;\r\n                    return new Date(end - ss);\r\n                }\r\n\r\n                /**\r\n                 * 计算请假时间的工作日\r\n                 * @param beginDay\r\n                 * @param endDay\r\n                 * @returns {*[天数, 小时数]}\r\n                 */\r\n                function getWorkDayCount (beginDay, endDay) {\r\n                    /*\r\n                    计算一段时间内工作的天数。不包括周末，周末为周六下午、周日一天半\r\n                    beginDay -时间段开始日期\r\n                    endDay -时间段结束日期\r\n                    */\r\n                    //每天的毫秒总数\r\n                    var daytime = 24 * 60 * 60 * 1000;\r\n                    //两个时间段相隔的总天数\r\n                    var days;\r\n                    days = (endDay - beginDay) / daytime;\r\n\r\n                    //减去不用上班的时间,即09-18之外的时间\r\n                    var beginDayHour = beginDay.getHours()<9 ? 9:beginDay.getHours();\r\n                    var endDayHour = endDay.getHours() > 18 ? 18 : endDay.getHours();\r\n                    var totalminutes = endDayHour*60+endDay.getMinutes() - beginDayHour*60-beginDay.getMinutes();\r\n\r\n                    //剩余的小时数\r\n                    var hours= totalminutes/60;\r\n\r\n                    //时间段起始时间所在周的第一天\r\n                    var beginWeekFirstDay=nearlyWeeks(0,beginDay.getTime()).getTime();\r\n                    //时间段结束时间所在周的最后一天\r\n                    var endWeekOverDay=nearlyWeeks(0,endDay.getTime()).getTime() + 6*daytime;\r\n                    //由beginWeekFirstDay和endWeekOverDay换算出，周末的天数\r\n                    var weekEndCount = ((endWeekOverDay - beginWeekFirstDay) / daytime + 1) / 7 * 1.5 - 1.5;\r\n                    \r\n                    //调整周末天数的值\r\n                    if(weekEndCount != 0){\r\n                        if(endDay.getDay()>0 && endDay.getDay<6)\r\n                            weekEndCount -=1.5;\r\n                        if (endDay.getDay() == 6)\r\n                            weekEndCount -= 0.5;\r\n                        if (beginDay.getDay() == 0) weekEndCount -= 0.5;\r\n                    }\r\n                    var weekInt = parseInt(weekEndCount);\r\n                    var weekfix = weekEndCount.toFixed(1) - parseInt(weekEndCount);\r\n                    if(weekfix >= 0.4 && weekfix <= 0.6) {\r\n                        weekfix = 0.5;\r\n                    } else {\r\n                        weekfix = 0;\r\n                    }\r\n\r\n                    //工作日 = 总天数 - 周末天数\r\n                    var dayInt = parseInt(days);\r\n                    var dayfix = days.toFixed(1) - parseInt(days);\r\n                    var day = dayInt - weekInt;\r\n                    if(dayfix >= 0.4 && dayfix <= 0.6) {\r\n                        dayfix = 0.5;\r\n                    } else if(dayfix < 0.4) {\r\n                        dayfix = 0;\r\n                    } else {\r\n                        day +=1;\r\n                        dayfix = 0;\r\n                    }\r\n                    hours += dayfix * 9;\r\n                    hours = hours - weekfix*9;\r\n\r\n                    day = hours < 0 ? (day -1) : day;\r\n                    hours = hours < 0 ? (hours + 9) : hours;\r\n                    hours = hours.toFixed(1);\r\n\r\n                    return [day, hours];\r\n                }\r\n            }\r\n        ])\r\n    \r\n        //请假记录\r\n        .controller('GetLeavesController', [\r\n            '$scope',\r\n            'LeaveService',\r\n            '$filter',\r\n            '$location',\r\n            'NgTableParams',\r\n            function ($scope, LeaveService, $filter, $location, NgTableParams) {\r\n                var self = this;\r\n                self.$injet = [\"NgTableParams\", \"ngTableSimpleList\"];\r\n               // self.defaultConfigTableParams = new NgTableParams({}, { dataset: data});\r\n                self.tableParams = createUsingFullOptions();\r\n                self.cols = [\r\n                    { field: \"created_at\", title: \"申请时间\", sortable: \"created_at\", show: true },\r\n                    { field: \"type\", title: \"请假原因\", show: true },\r\n                    { field: \"grant\", title: \"审批结果\", show: true },\r\n                    { field: \"begin\", title: \"开始请假时间\", sortable: \"begin\", show: true},\r\n                    { field: \"end\", title: \"结束请假时间\", sortable: \"end\", show: true},\r\n                    { field: \"total_time\", title: \"合计请假时数\", sortable: \"total_time\", show: true}\r\n                ];\r\n\r\n                function createUsingFullOptions() {\r\n                    var initialParams = {\r\n                        page: 1,\r\n                        sorting: { created_at: \"asc\" }\r\n                    };\r\n                    var initialSettings = {\r\n                        filterDelay: 0,\r\n                        paginationMaxBlocks: 3,\r\n                        paginationMinBlocks: 2,\r\n                        getData: function(params) {\r\n                            $location.search(params.url()); // 将参数放到url上，实现刷新页面不会跳回第一页和默认配置\r\n                           return LeaveService.fnGetLeaves(params);\r\n                        }\r\n                    };\r\n                    return new NgTableParams(initialParams, initialSettings);\r\n                }\r\n\r\n            }\r\n        ])\r\n\r\n\r\n})();"]}